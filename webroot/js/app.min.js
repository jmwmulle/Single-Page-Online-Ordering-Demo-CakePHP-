function array_remove(e,t,r){var a=e.slice((r||t)+1||e.length);return e.length=0>t?e.length+t:t,e.push.apply(e,a)}function isEvent(e,t){if(t&&pr(e,"isEvent:"+t),"object"!=typeof e)return!1;var r=["bubbles","cancelable","currentTarget","eventPhase","timeStamp","type"];for(i in r)return r[i]in e?!0:!1}function is_object(e){return"object"==typeof e&&null!=e}function is_array(e){return e instanceof Array}function isFloat(e){return e===+e&&e!==(0|e)}function isInt(e){return e===+e&&e===(0|e)}function is_string(e){return"string"==typeof e}function is_function(e){return"function"==typeof e}function isValidJSON(e,t){try{var r=JSON.parse(e);if(r&&"object"==typeof r&&null!==r)return t===!0?r:!0}catch(a){}return!1}function createCustomEvent(e,t){var r={bubbles:!0,cancelable:!1,eventPhase:0,type:e};if("object"==typeof t)for(var a in t)t.hasOwnProperty(a)&&(r[a]=t[a]);return jQuery.Event(e,r)}function is_mobile(){var e=!1;return function(t,r){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}function eTypeOf(e){return isEvent(e)?e.type:!1}function px_to_int(e){return Number(e.split("px")[0])}function as_id(e){return"string"==typeof e?"#"===e.substring(0,1)?e:"#"+e:!1}function camelcase_to_pep8(e){return str_to_lower(e.replace(/\W+/g,"-").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/([a-z\d])([0-9]{1,})/g,"$1_$2"))}function array_intersect(e,t){e=e.sort(),t=t.sort();for(var r=bi=0,a=[];r<e.length&&bi<t.length;)e[r]<t[bi]?r++:e[r]>t[bi]?bi++:(a.push(r),r++,bi++);return a}function as_class(e){return"string"==typeof e?"."===e.substring(0,1)?e:"."+e:!1}function sel_to_str(e){try{return e.replace("-"," ").replace("_"," ").toTitleCase()}catch(t){return pr(t,"ERROR:sel_to_str()"),e}}function now(){return(new Date).getTime()}function stripCSS(e){return"."==e.substring(0,1)||"#"==e.substring(0,1)?e.substring(1):e}function matchWindowHeight(e,t){var r=window.innerHeight;if("[object Array]"===Object.prototype.toString.call(t))for(var a=0;a<t.length;a++)r-=$(t[a]).innerHeight();else"int"==typeof t?r-=$(t).innerHeight():"int"==typeof t&&(r-=t);return $(e).css("min-height",r),!0}function flash(e){if("@clear"==e)return $("#flash-content").html(""),!0;var t='   <div id="flash-message" class="text-center error">       <span>'+e+"</span>   </div>";return $("#flash-content").html(t),!0}function cakeUrl(e,t,r,a){if(r){if(r.constructor===Array){var i=WWW+DS+APP+DS+e+DS+t+DS+r.join(DS);return a?pr(i):null,i}if(r.constructor===Object){var s="";for(p in r)s+=DS+r[p];var i=WWW+DS+APP+DS+e+DS+t+s;return a?pr(i):null,i}var i=WWW+DS+APP+DS+e+DS+t+DS+r;return a?pr(i):null,i}var i=WWW+DS+APP+DS+e+DS+t;return a?pr(i):null,i}function in_array(e,t){return t.indexOf(e)>-1}function pr(e,t,r){for(var a=(new Error).stack.split("\n").slice(2),i=[],s="Null",n="//nowhere",o="-1",l=0;l<a.length-1;l++){try{s=a[l].match(/^ at (.*) \(/)[1]}catch(c){}try{n="/"+a[l].match(/^.*\/\/[a-z.-]*\/(.*):[0-9]*:[0-9]*/)[1]}catch(c){}try{o=a[l].match(/^.*\/\/[a-z.-]*\/.*:([0-9]*):[0-9]*/)[1]}catch(c){}i.push(s+" in  "+n+":"+o)}console.log("\nPrinting From: "+i[0]+"\n");var u=1==r?"error":"log";t=t&&"string"==typeof t?"%c "+t+" ":"%c";var d="*",h=d.length,_="rgb(52, 61, 76)",p="rgb(247, 126, 239)";switch(r){case 1:var f="color:rgb(255,0,0); text-transform:uppercase; background-color:rgb(255,245,245); border:1px solid rgb(255,0,0);";break;case 2:var m="color:rgb(100,160,175); background-color:"+_+"; border:1px solid rgb(35,55,63); border-right:none;",g="color:rgb(100,160,175); background-color:"+_+"; border:1px solid rgb(35,55,63); border-left:none, border-right:none;",b="color:rgb(100,160,175); background-color:"+_+"; border:1px solid rgb(35,55,63); border-left:none;",v=t.replace("[","__LBRAC__"),v=v.replace("]","__RBRAC__"),v=v.replace(/__LBRAC__(.*)__RBRAC__/,"[%c$1%c]"),S=!1,C=!1;t!=v&&(t=v,S=!0),t=t.replace(/\((.*)\)/,"(%c$1%c) %c");var k=t.replace(/(#)/,"%c#%c %c");k!=t&&(C=!0,t=k);break;default:var f="color:rgb(0,150,0); text-transform:uppercase; background-color:rgb(245,245,245); border:1px solid rgb(220,220,220);"}var y="color:rgb(200,200,200); font-style:italics; display:inline-block; width: 12px; min-width:12px; max-width:12px;",T="color:rgb(0,0,100);",X="color:rgb(225,125,80); font-weight: bold",w="color:rgb(125,125,125); font-family:arial",$="color:#008cba; background-color:rgb(247,247,247); border:1px solid #008cba;",x="color:rgb(252,122,0); background-color:"+_+"; border-top:1px solid rgb(35,55,63); border-bottom:1px solid rgb(35,55,63);",E="color:"+p+"; background-color:"+_+"; border-top:1px solid rgb(35,55,63); border-bottom:1px solid rgb(35,55,63);",R="color:rgb(252,240,244); background-color:"+_+"; border-top:1px solid rgb(35,55,63); border-bottom:1px solid rgb(35,55,63);",M=2==r||3==r;if(M){switch(e){case e===!1:t+="%s",e="false";break;case e===!0:t+="%s",e="true";break;case null===e:t+="%s",e="null";break;case"undefined"==typeof e:t+="%s",e="undefined";break;case"number"==typeof e:break;default:t+="%O"}S?console[u](t,m,E,g,x,b,R,e):console[u](t,m,x,b,R,e)}else switch(e){case 0===e:console[u](t+"%c(int) %c",f,y,T,0);break;case 1===e:console[u](t+"%c(int) %c%s",f,y,T,1);break;case e===!1:console[u](t+"%c(bool) %c%s",f,y,X,"false");break;case e===!0:console[u](t+"%c(bool) %c%s",f,y,X,"true");break;case null===e:console[u](t+"%c(!def) %c%s",f,y,X,"null");break;case"undefined"==typeof e:console[u](t+"%c(!def) %c%s",f,y,X,"undefined");break;case"string"==typeof e:e.substring(0,h)===d?console[u](t+"%c%s",f,$," "+e.substring(1)+" "):console[u](t+"%c(str) %c%s",f,y,w,e);break;case"number"==typeof e:e%1===0?console[u](t+"%c(int) %c%s",f,y,T,e):console[u](t+"%c(float) %c%s",f,y,T,e);break;default:console[u](t+"%c(obj) %O",f,y,e)}return null}function tr(e){pr(e,"err",!0)}function split_path(e,t){if("string"!=typeof e)return!1;e=e.substr(-1,1)===t?e.substring(0,e.length-1):e,e=e.substr(0,1)===t?e.substring(1):e,e=e.replace("\\"+t,"$DIRECTORY_SEPARATOR").split(t);for(var r=0;r<e.length;r++)e[r].replace("$DIRECTORY_SEPARATOR",t);return e}function ucfirst(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}function str_to_lower(e){return e.charAt(0).toLowerCase()+e.slice(1).toLowerCase()}function str_to_upper(e){return e.toUpperCase()}function camel_to_snake(e){return e.replace(/([A-Z])/g,function(e){return"_"+e.toLowerCase()})}function title_to_snake(e){return e=str_to_lower(e[0])+e.slice(1),e.replace(/([A-Z])/g,function(e){return"_"+e.toLowerCase()})}function title_case(e){e=e.replace("_"," ").split(" ");for(var t=0;t<e.length;t++)e[t]=ucfirst(e[t]);return e.join(" ")}function flip(e){return 0===e||1===e?0==e:e===!1||e===!0?0==e:"0"===e||"1"===e?"0"==e:"true"===e||"false"===e?"false"==e:"True"===e||"False"===e?"False"==e:null===e||"undefined"===e?"NULL_NOT_BOOL":"BOOLEAN_NOT_PASSED"}function integer_keys(e,t){if(!is_object(e))return!1;if(is_array(e))return e;var r={};for(var a in e)try{r[Number(a)]=e[a]}catch(i){r[a]=e[a]}return r}function obj_values(e,t,r){var a=[],i=-1;if(0>t&&(t=e.length-Math.abs(t)),r||r==e.length,0>r&&(r=e.length-Math.abs(t)),r>t)throw"ValueError: end index cannot precede start index";for(var s in e)i++,i>=t&&r>=i&&a.push(e[s]);return a}function obj_keys(e){var t=[];for(var r in e)t.push(r);return t}function exists(e){return jQuery(e).length>0}function clearForm(e){$("#"+e)[0].reset()}function strpad(e,t,r,a,i){if("number"==typeof e&&(e=e.toString()),r=r?r:"0",i){var s=e.split(".")[1];if(s&&s.length>0){e+="."!=e.substring(0,1)?".":null;for(var n=0;i>n;n++)e+=toString(0)}}var o=t-e.length;if(1>o)return e;var l="";if(-1!==a){for(var c=0;o>c;c++)l+=r;return l+e}for(var c=0;o>c;c++)e+=r;return e}function copy(e){var t=null;if(is_array(e))t=Array();else{if("string"==typeof e)return""+e;if(!is_object(e))return isInt(e)||isFloat(e)?0+e:e===!0||e===!1?e===!0:null;t={}}for(var r in e)t[r]=e[r];for(var r in e.prototype)t.prototype[r]=e.prototype[r];return t}function obj_len(e){var t,r=0;for(t in e)e.hasOwnProperty(t)&&r++;return r}function b64JSON(e){return btoa(JSON.stringify(e))}function die(){function e(){Error.apply(this,arguments),this.name="ExitRequest"}throw e.prototype=Object.create(Error.prototype),new e("Exiting..")}function obj_merge(e,t){if(!is_object(e)||!is_object(t))throw"keys_obj and vals_obj must both be javascript objects";var r={};for(var a in e)r[a]=a in t?t[a]:e[a];for(var a in t)a in r||(r[a]=t[a]);return r}function inherits(e){function t(){}return t.prototype=e.prototype,new t}function strip_orphan_text_nodes(e){for(var t=[],r=0;r<e.length;r++)"#text"!=e[r].nodeName&&t.push(e[r]);return t.length>1?t:t[0]}function tab_out(e,t,r){if(allow_tab_out)try{if(null===e&&(e="null"),e===!0&&(e="true"),e===!1&&(e="false"),r){var a={e_txt:e.message,e_stack:e.stack};e=sprintf("<pre>%s</pre>",JSON.stringify(a,null,"	"))}"string"!=typeof e&&(e=sprintf("<pre>%s</pre>",JSON.stringify(e,null,"	")));var i=$("<div/>").addClass("jsc-line");t||(t="----"),$(i).append($("<div/>").addClass("tout-label").html(t)),$(i).append($("<div/>").addClass("tout-text").html(e)),$("main#js-console").append(i)}catch(s){$("body").style({backgroundColor:"yellow"}),setTimeout(function(){$("body").css({backgroundColor:"yellow"}),$("main").hide(),$("body").append($("<div/>").css({marginTop:"80px"}).html(s.message))},250)}}function tout_show(e){allow_tab_out&&(e=e?e:"anon",$("h4#called-from").html(e),$("main").hide(),setTimeout(function(){$("main#js-console").show(),setTimeout(function(){$("main#js-console").css({position:"fixed",top:"80px",left:"0px",zIndex:9999999})},100)},50))}function XtremePrinter(){return this.printer_available=!1,this.ip=null,this.status=null,this.queue={},this.styles={},this.tab_out=function(e,t){tab_out(e,t)},this.tout_show=function(){tout_show()},this.style_template=function(){return{indent:0,scale:1,line_h:1,align:C.LEFT,bold:!1,underline:!1}},this.virtual_receipts=[],this.init=function(e){this.status=this.open_printer(e),this.add_style("default",0,"left",3,1.5,!1,!1),this.extend_style("center","default",{align:"center"}),this.extend_style("right","default",{align:"right"}),this.extend_style("orb_opt","default",{indent:2,scale:2}),this.add_style("h1",0,"center",7.5,5,!0,!1),this.extend_style("h2","h1",{scale:4,line_h:6}),this.extend_style("h3","h1",{scale:3,line_h:4.5}),this.extend_style("h4","h1",{scale:2,line_h:3}),this.extend_style("h5","h1",{scale:1,line_h:2})},this.dequeue=function(){var e,t={},r=0;for(var a in this.queue)0==r?e=this.queue[a]:t[a-1]=this.queue[a],r++;return this.queue=t,e},this.print_from_queue=function(){var e={success:!0,error:!1,line:null,queue_empty:!1,raw:null};if(this.queued()){var t=this.dequeue(),r=in_array(t.text,[C.CUT,C.FEED_CUT]);if(t.text!=C.CUT){in_array(t.text,C.FEED,C.FEED_CUT)&&(t.text=" \n");var a=this.print(t.text,t.style,r);a.success===!1&&(e.success=!1,e.error=a,e.line=t)}r&&this.cut(!0)}else this.cut(!0),e.queue_empty=!0;return e},this.queued=function(){return obj_len(this.queue)>0},this.open_printer=function(e){var t;return XBS.printer.is_xtreme_tablet(),t=e?Android.openPrinter(e):Android.openDefaultPrinter(),t=t.split(":"),t={success:1===parseInt(t[0]),error:"false"==t[1]?!1:t[1]},this.printer_available=t.success?!0:!1,this.ip=t.ip,this.status=t,t},this.play_order_tone=function(){if(XBS.printer.is_xtreme_tablet())Android.playTone();else{var e=new Audio(XSM.vendor.new_order_tone);e.play()}},this.feed_line=function(e){e||0==e||(e=1);for(var t=0;e>t;t++)this.queue_line(" \n","default")},this.queue_line=function(e,t,r){r||(r=0);var a=obj_len(this.queue);this.queue[a]=t?{style:t,text:e}:{style:"default",text:e},this.queue[a+1]={style:"default",text:" "}},this.has_virtual_receipts=function(){return is_array(this.virtual_receipts)?this.virtual_receipts.length>0:(this.virtual_receipts=[],!1)},this.queue_order=function(e){pr(e,"the order"),tab_out("arrived","queue_order()");try{this.queue_line(sprintf("Ordered At: %s",e.time),"h4",1),this.queue_line(sprintf("For: %s",e.order_method),"h2",1),e.order_method==C.DELIVERY&&(e.customer&&this.queue_line(e.customer,"center","h3"),e.address&&this.queue_line(e.address,"center","h3"),e.delivery_instructions&&this.queue_line(e.delivery_instructions,"h4")),this.queue_line(sprintf("Payment Status: %s",e.paid?"PAYED":"OWED"),"h3",1),this.queue_line(sprintf("Payment Type: %s",e.payment_method),"h4"),this.__queue_orb_list(e.food),this.queue_line(sprintf("TOTAL: $%s",e.price),"h2")}catch(t){return tab_out(t,"queue_order() error",!0),!1}return pr(this.queue,"the queue"),this.queue},this.add_style=function(e,t,r,a,i,s,n){return this.styles[e]={align:r?r:"left",line_h:a?a:1,scale:i?i:1,indent:t?t:0,bold:s?s:!1,underline:n?n:!1},!0},this.extend_style=function(e,t,r){try{var a=this.style_template();for(var i in a)a[i]=i in r?r[i]:this.styles[t][i];return this.styles[e]=a,{name:e,style:a}}catch(s){return s}},this.show_dialog=function(e,t){this.printer_available&&Android.showDialog(e,t)},this.print=function(e,t,r){pr({text:e,style:t,virtual_cut:r},"XtremePrinter::print(text, style, virtual_cut)",2),tab_out({text:e,style:t},"print()");var a=null,i=XBS.printer.styles[t];try{this.printer_available?a=Android.printText(e,1,i.align,i.line_h,i.scale,i.scale,i.indent,i.bold,i.underline):((r||0===this.virtual_receipts.length)&&this.virtual_receipts.unshift([]),this.virtual_receipts[0].push($("<li/>").addClass(["virtual-receipt",t]).html(e)),a={success:!0,error:!1})}catch(s){tab_out(s,"print error",!0)}return a},this.cut=function(e){Android.cut(e===!0?e:!1)},this.__queue_orb_list=function(e){try{for(var t in e){var r=e[t];try{this.queue_line(sprintf("$%s   (%s) x %s %s",r.price,r.quantity,r.size,t),"h4");for(var a in r.opts)this.queue_line(sprintf("%s: %s",r.opts[a].weight,r.opts[a].title),"orb_opt"),r.instructions&&this.queue_line(r.instructions,"opt_note")}catch(i){tab_out({e_txt:i.message,e_stack:sprintf("<pre>%s</pre>",JSON.stringify(i.stack,null,"	"))},"__format_orbs() error")}}}catch(i){tab_out({e_txt:i.message,e_stack:sprintf("<pre>%s</pre>",JSON.stringify(i.stack,null,"	"))},"__queue_orb_list() error")}return!0},this.render_virtual_receipt=function(){if(pr(this.virtual_receipts,"XtremePrinter::render_virtual_receipt()",2),!this.virtual_receipts.length){for(var e=$("<ul/>").attr("id","virtual-receipt").addClass("virtual-receipt-container"),t=0;t<this.virtual_receipts.length;t++){for(var r=$("<li />"),a=$("<ul />").addClass("virtual-receipt receipt"),i=0;i<this.virtual_receipts[t].length;i++)$(a).append(this.virtual_receipts[t][i]);$(r).append(a),$(e).append(r)}return $(C.BODY).append(e),this.virtual_receipts=[],!0}},this.is_xtreme_tablet=function(){return navigator.userAgent==C.XTREME_TABLET_USER_AGENT},this}function EffectChain(e){return this.init(e),this}function validate_address(e,t){var r=2;r>0&&pr([e,t],"XBS.validation.submit_address(route)",2),$(XSM.forms.order_address_form).validate({debug:!0,rules:{"data[orderAddress][firstname]":"required","data[orderAddress][phone]":{required:!0,phoneUS:!0},"data[orderAddress][address]":"required","data[orderAddress][email]":{required:!0,email:!0},"data[orderAddress][postal_code]":{required:!0,minlength:6,maxlength:7}},messages:{"data[orderAddress][firstname]":"Well we have to call you <em>something!</em>","data[orderAddress][email]":"No spam, promiseâ€”just for sending receipts!","data[orderAddress][phone]":{required:"We'll need this in case there's a problem with your order.",phoneUS:"Just ten little digits, separated by hyphens if you like..."},"data[orderAddress][address]":"It's, err, <em>delivery</em> after all...","data[orderAddress][postal_code]":{required:"This is how we check if you're in our delivery area!",minlength:'Prooooobably something like "A0A 0A0"...',maxlength:'Prooooobably something like "A0A 0A0"...'}},submitHandler:function(){$.ajax({type:C.POST,url:"confirm-address/session",data:$(XSM.forms.order_address_form).serialize(),success:function(t){r>1&&pr($.parseJSON(t),"XBS.validation.submit_address()->confirm_address_validation",2);try{new Modal(C.PRIMARY).hide(),XT.cart.import_cart(t.cart);var a;switch(e){case"menu":a="menu/unstash";break;case"review":a="review_order"}setTimeout(function(){$(XT.router).trigger(C.ROUTE_REQUEST,{request:a,trigger:{}})},300)}catch(i){pr(i,null,!0)}}})}}),$(XSM.forms.order_address_form).submit()}function validate_register(e,t){var r=0;r>0&&pr(route,"XBS.validation.submit_address(route)",2),$(XSM.forms.users_form).validate({debug:!0,rules:{"data[Users][firstname]":"required","data[Users][email]":{required:!0,email:!0},"data[Users][phone]":{required:!0,phoneUS:!0},"data[Users][address]":"required","data[Users][postal_code]":{required:!0,minlength:6,maxlength:7}},messages:{"data[Users][firstname]":"Well we have to call you <em>something!</em>","data[Users][email]":"This will be your 'username'. Don't worry, we won't share it or spam you!","data[Users][phone]":{required:"We'll need route in case there's a problem with your order.",phoneUS:"Jusst ten little digits, separated by hyphens if you like..."},"data[Users][address]":"It's, err, <em>delivery</em> after all...","data[Users][postal_code]":{required:"This is how we check if you're in our delivery area!",minlength:'Prooooobably something like "A0A 0A0"...',maxlength:'Prooooobably something like "A0A 0A0"...'}},submitHandler:function(){$.ajax({type:route.url.type,url:"users/add",data:$(XSM.forms.users_form).serialize(),success:function(e){},fail:function(){},always:function(){}})}}),$(XSM.forms.users_form).submit()}var test="hi mom";$.fn.scrollTo=function(e,t,r){"function"==typeof t&&2==arguments.length&&(r=t,t=e);var a=$.extend({scrollTarget:e,offsetTop:50,duration:500,easing:"swing"},t);return this.each(function(){var e=$(this),t="number"==typeof a.scrollTarget?a.scrollTarget:$(a.scrollTarget),i="number"==typeof t?t:t.offset().top+e.scrollTop()-parseInt(a.offsetTop);e.animate({scrollTop:i},parseInt(a.duration),a.easing,function(){"function"==typeof r&&r.call(this)})})},String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,r){return"undefined"!=typeof e[r]?e[r]:t})}),String.prototype.toTitleCase||(String.prototype.toTitleCase=function(){return this.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}),$("#reset-form").click(function(){{var e=$(this).attr("data-refresh");$(this).attr("data-formid")}0==e?clearForm():location.reload()}),window.xtr.route_collections.layout_api=function(){return this.flash={params:{type:{url_fragment:!1}},modal:XSM.modal.flash,behavior:C.OL,callbacks:{launch:function(){$(this.modal_content).html("<h5>Oh Noes!</h5><p>Something went awry there. Let us know so we can fix it!</p>"),$(this.modal).removeClass(XSM.effects.slide_up)}}},this.footer={params:["method"],callbacks:{launch:function(){$(XSM.global.footer).hasClass("reveal")&&($(XSM.global.footer).addClass("stow"),setTimeout(function(){$(XSM.global.footer).removeClass("reveal"),setTimeout(function(){$(XSM.global.footer).removeClass("stow")},30)},30)),$(XSM.global.footer).hasClass("reveal")||$(XSM.global.footer).addClass("reveal")}}},this.launch_apology={url:{url:"launch-apology",type:C.GET,defer:!0},modal:XSM.modal.primary,params:["action"],callbacks:{params_set:function(){"close"==this.read("action")&&(this.unset("url"),XBS.layout.dismiss_modal(this.modal))}}},this},XT.route_collections.menu_ui=function(){return this.favorite={params:{context:{value:null,url_fragment:!1}},url:{url:"favorite"},data:!1,callbacks:{modal:C.FLASH,params:function(){this.data=$(XSM.menu.orb_order_form).serialize()},launch:function(e,t){pr(t)}}},this.menu={params:["reveal_method"],modal:C.PRIMARY,url:{url:"menu"},callbacks:{params_set:function(){"unstash"==this.read("reveal_method")&&(this.unset("url"),this.unset("launch_callback"),this.modal.hide(),setTimeout(function(){XT.menu.unstash()},300))},launch:function(){window.xtr.splash.fold()}}},this.menuitem={url:{url:"menuitem"},params:{orb_id:{value:null,url_fragment:!0}}},this.orbcat={url:{url:"menu",defer:!0},params:{id:{value:null,url_fragment:!0},name:{}},callbacks:{launch:function(){XT.router.cake_ajax_response(this.deferral_data,{callback:function(e){XT.orbcard.load_menu(e.data)}},!1,!1)}}},this.price_rank={params:["rank"],propagates:!1,callbacks:{params_set:function(){XT.orbcard.orb.price_rank.set(this.read("rank"))}}},this.orb_opt={params:["action","id"],propagates:!1,callbacks:{params_set:function(){XT.orbcard.orb.toggle_opt(this.read("id"))}}},this.orb_opt_weight={propagates:!1,params:["id","weight"],propagates:!1,callbacks:{params_set:function(){XT.orbcard.orb.toggle_opt(this.read("id"),this.read("weight"))}}},this.optflag={params:["target","action"],callbacks:{launch:function(){XT.orbcard.toggle_filter(this.read("target"))}}},this.load_orb={url:{url:"menu-item",type:C.GET,defer:!0},params:{id:{url_fragment:!0},fart:{url_fragment:!0,value:"poop"}},propagates:!1,callbacks:{launch:function(){XT.router.cake_ajax_response(this.deferral_data,{callback:function(e,t){setTimeout(function(){XT.orbcard.load_orb(t.id,e.data.view_data)},XT.orbcard.reset_stage())},data:{id:this.read("id")}},!1,!1)}}},this.configure_orb={params:["id","rank"],callbacks:{params_set:function(){XT.orbcard.configure(this.read("id"),this.read("rank"))},launch:function(){XT.orbcard.show_face(C.BACK)}}},this.orb_card={params:["action","action_arg","data"],stop_propagation:!0,callbacks:{params_set:function(){var e=!1;switch(this.read("action")){case"add_to_cart":switch(this.read("action_arg")){case"confirm":this.url={url:"add-to-cart",type:C.POST,defer:!0,data:$(XSM.menu.orb_order_form).serialize()},e=function(){try{var e=JSON.parse(this.deferral_data);1==e.success&&window.xtr.cart.add_to_cart()&&XT.layout.reveal_orb_card_modal()}catch(t){throw"Add to cart failed at server:\n "+this.deferral_data}};break;case"cancel":e=XT.menu.reset_orb_card_stage()}break;default:e=function(){XT.menu.toggle_orb_card_row_menu(this.read("action"),null)}}e&&this.set_callback("launch",e)}}},this.validate_form={params:["target","restore","delegate"],callbacks:{params_set:function(){pr(this.params,"vfrom"),XT.validate(this.read("target"),this.read("restore"),this.read("delegate"))}}},this.close_modal={params:["modal"],callbacks:{launch:function(){new Modal(this.read("modal")).hide(!0)}}},this.orbcard_modal={params:["action","target"],propagates:!1,modal:C.PRIMARY,callbacks:{params_set:function(){switch(XT.orbcard.show_face(C.FRONT),this.read("action")){case"continue_ordering":setTimeout(function(){XT.orbcard.modal.hide(),XT.orbcard.reset_stage()},900);break;case"view":XT.orbcard.modal.hide(),this.url={url:["review",this.read("target")].join("-"),defer:!1,type:C.GET},this.stash=!0}}}},this},window.xtr.route_collections.orders_api=function(){return this.finalize_order={url:{url:"orders"+C.DS+"finalize",defer:!0,data:$("#OrderReviewForm").serialize(),type:C.POST},callbacks:{launch:function(){var e=$.parseJSON(this.deferral_data),t=this.trigger;if(!e.error&&e.order_id){var r="pending_order"+C.DS+e.order_id+C.DS+"launching";$(XT.router).trigger(C.ROUTE_REQUEST,{request:r,trigger:t.event})}}}},this.review_order={url:{url:"review-order",type:C.GET,defer:!1},params:["context"],modal:C.PRIMARY,callbacks:{params_set:function(){this.modal.hide()}}},this.order_accepted={url:"order-accepted",modal:C.PRIMARY},this.splash_order={params:{method:{value:null,url_fragment:!1}},callbacks:{launch:function(){$(XSM.splash.order_delivery).removeClass(XSM.effects.slide_left),$(XSM.splash.order_pickup).removeClass(XSM.effects.slide_right)}}},this.payment_method={params:["context","action"],modal:C.PRIMARY,callbacks:{params_set:function(){switch(this.read("context")){case"review_modal":this.modal.payment_method(this.read("action"))}}}},this.pending_order={params:{order_id:{value:null,url_fragment:!0},status:{value:null,url_fragment:!0}},modal:C.PRIMARY,url:{url:"order-confirmation",defer:!0,type:C.POST},callbacks:{params_set:function(){switch(this.read("status")){case"launching":this.params.status={value:!0},this.url.defer=!1;var e={request:"pending_order"+C.DS+this.read("order_id")+C.DS+C.PENDING,trigger:this.trigger};setTimeout(function(){$(window.xtr.router).trigger(C.ROUTE_REQUEST,e)},3e3),this.unset("launch_callback")}},launch:function(){var e=$.parseJSON(this.deferral_data);switch(Number(e.status)){case C.REJECTED:break;case C.ACCEPTED:$(window.xtr.router).trigger(C.ROUTE_REQUEST,{request:"order_accepted",trigger:this.trigger});break;default:var t={request:"pending_order"+C.DS+this.read("order_id")+C.DS+C.PENDING,trigger:this.trigger};setTimeout(function(){$(window.xtr.router).trigger(C.ROUTE_REQUEST,t)},3e3)}}}},this.set_delivery_address={modal:C.PRIMARY,url:{url:"set-address",type:C.GET,defer:!1},params:{context:{url_fragment:!0},restore:{url_fragment:!1}},callbacks:{params_set:function(){if("cancel"==this.read("context"))switch(this.unset("url"),this.unset("launch"),this.read("restore")){case"menu":this.modal.hide(),XT.menu.unstash(),setTimeout(function(){$(XT.router).trigger(C.ROUTE_REQUEST,{request:"set_order_method/menu/just_browsing",trigger:{}}),XT.cart.set_order_method(C.JUST_BROWSING)},300);break;case"review":$(XT.router).trigger(C.ROUTE_REQUEST,{request:"review_order",trigger:{}});default:this.modal.hide()}}}},this.set_order_method={modal:C.PRIMARY,url:{url:"order-method",type:C.POST,defer:!0},stash:!0,params:{context:{value:null,url_fragment:!0},method:{value:null,url_fragment:!0}},callbacks:{params_set:function(){"menu"==this.read("context")&&"delivery"!=this.read("method")&&(this.stash=!1)},launch:function(){XT.router.cake_ajax_response(this.deferral_data,{callback:function(e){XT.cart.import_cart(e.data.Cart)}},!0,!0)}}},this.set_user_address={params:["id","action"],modal:C.PRIMARY,callbacks:{params_set:function(){switch(this.read("action")){case"reveal":this.modal.reveal_user_addresses(this.modal,this.read("id"));break;case"set":this.modal.populate_address_form(this.modal,this.read("id"))}}}},this.clear_cart={url:{url:"clear-cart",type:C.POST,defer:!0},callbacks:{launch:function(){XT.router.cake_ajax_response(this.deferral_data)}}},this.edit_orb={url:{url:"update",type:C.POST,defer:!0},params:{uid:{url_fragment:!0},opt_id:{url_fragment:!0}},modal:C.PRIMARY,callbacks:{launch:function(){XT.router.cake_ajax_response(this.deferral_data,{callback:function(e,t){XT.cart.import_cart(e.data.cart),XT.cart.session_data.Order.length>0?XT.cart.update(t.uid,t.target):$(XT.router).trigger(C.ROUTE_REQUEST,{request:"orbcard_modal/view/cart",trigger:{}})},data:{uid:this.read("uid"),target:this.trigger.element}},!0,!0)}}},this.cart={modal:C.PRIMARY,params:["action","action_arg","data"],propagates:!1,url:{url:"add-to-cart",type:C.POST,defer:!0},callbacks:{params_set:function(){switch(this.read("action")){case"add":this.url.data=$(XSM.menu.orb_order_form).serialize();break;case"review":this.url={url:"review-cart",type:C.GET,defer:!1},this.stash=!0,this.unset("launch");break;default:this.unset(["url","launch"]),XT.orbcard.reset_stage(!0)}},launch:function(){XT.router.cake_ajax_response(this.deferral_data,{callback:function(e){XT.cart.import_cart(e.data.Cart),exists(e.delegate_route)||(pr(XT.orbcard.modal),XT.orbcard.modal.show())}},!0,!0)}}},this},window.xtr.route_collections.tablet_ui=function(){return this.tablet_print={params:["context"],callbacks:{params_set:function(){var e=0;e>0&&pr(XBS.printer.queue,"ROUTE: print_from_queue");var t;switch(this.read("context")){case"vendor_accepted":t=XBS.printer.queued()?XBS.printer.print_from_queue():!1;break;case"line_complete":t=XBS.printer.queued()?XBS.printer.print_from_queue():!1,XBS.printer.queued()||XBS.printer.cut(!0)}t===!1&&this.unset("launch")},launch:function(){try{$(XBS.routing).trigger(C.ROUTE_REQUEST,{request:"print_from_queue/line_complete",trigger:{}})}catch(e){pr(e)}}}},this.tablet_fetch_pending={url:{url:"pending",defer:!0,type:C.GET},callbacks:{params_set:function(){var e=0;e>0&&pr("<no_args>","XBS.routing.vendor_get_pending()::params_set",2),XBS.vendor.last_check||(XBS.vendor.last_check=now(),this.unset("url")),now()-XBS.vendor.last_check<3e3&&this.unset("url")},launch:function(){if(this.url.url){XBS.vendor.last_check=now();var e=$.parseJSON(this.deferral_data);!e.error&&e.orders.length>0&&XBS.vendor.post_orders(e.orders)}setTimeout(function(){$(XBS.routing).trigger(C.ROUTE_REQUEST,{request:"vendor_get_pending",trigger:{}})},500)}}},this.tablet_reject={params:["state"],callbacks:{params_set:function(){switch(this.read("state")){case"unconfirmed":$(XSM.vendor.order_reject_confirmation).removeClass(XSM.effects.slide_left);break;case"confirm":this.url={url:"vendor-reject"+C.DS+XBS.vendor.current().id+C.DS+C.REJECTED,type:C.POST,defer:!0},this.set_callback("launch",function(){$.parseJSON(this.deferral_data);$(XSM.vendor.order_reject_confirmation).addClass(XSM.effects.slide_left)});break;case"cancel":$(XSM.vendor.order_reject_confirmation).addClass(XSM.effects.slide_left)}}}},this.tablet_accept={params:["method","context"],url:{url:"vendor-accept",type:C.POST,defer:!0},callbacks:{params_set:function(){this.url.url+=C.DS+XBS.vendor.current().id+C.DS+C.ACCEPTED,$(XSM.vendor.accept_acknowledge).show(),setTimeout(function(){$(XSM.vendor.accept_acknowledge).addClass(XSM.effects.exposed),setTimeout(function(){$(XSM.vendor.accept_acknowledge).removeClass(XSM.effects.exposed).hide()},300)},30),XBS.vendor.last_check=-1e5},launch:function(){var e=$.parseJSON(this.deferral_data);if(e.success){var t=XBS.vendor.current();XBS.vendor.pending_orders.shift(),XBS.vendor.current_order=null,XBS.vendor.last_check=now(),$(XSM.vendor.order_accept_button).removeClass(XSM.effects.launching),$(XSM.vendor.order_accepted).addClass(XSM.effects.fade_out),XBS.printer.queue_order(t),$(XBS.routing).trigger(C.ROUTE_REQUEST,{request:"print_from_queue/vendor_accepted",trigger:{}}),XBS.vendor.next()}}}},this},window.xtr.route_collections.user_accounts=function(){return this.login={url:{url:!1,type:C.POST},modal:XSM.modal.primary,params:{context:{},channel:{url_fragment:!0},restore:{}},callbacks:{params_set:function(){var e=this.read("context"),t=this.read("channel"),r=this.read("restore");

switch(pr(this.params,"login::params"),e){case"confirm-address":switch(t){case"email":this.unset("url"),this.set_callback("launch",function(){$(XBS.routing).trigger(C.ROUTE_REQUEST,{request:"login/modal/email/confirm-address",trigger:this.trigger})});break;default:this.unset("url"),this.unset("modal"),this.set_callback("launch",function(){$(XSM.modal.confirm_address_login_panel).hide().removeClass(XSM.effects.true_hidden),setTimeout(function(){$(XSM.modal.confirm_address_login_panel).show("clip")},30)})}break;case"modal":this.url={url:"login/email",defer:!1,type:C.GET},r&&this.set_callback("launch",function(){pr("got here"),$("#on-close").replaceWith('<div id="on-close" class="true-hidden" data-action="restore/confirm_address"></div>')});break;default:"email"==t&&(this.url.url="login/email",this.url.type=C.GET,this.set_callback("launch",function(){pr("login/email"),pr(this.deferral_data)}))}},launch:function(){window.location="http://development-xtreme-pizza.ca/auth/"+this.read("channel")}}},this.register={modal:XSM.modal.primary,url:{url:"sign-up",type:C.POST,defer:!0},params:{context:{},channel:{value:null,url_fragment:!1},restore:{},hide_reg:{value:!1}},callbacks:{params_set:function(){var e=this.read("channel");switch(this.read("context")){case"modal":this.url.defer=!0,in_array(e,["email","submit"])&&(this.url.url=!1),in_array(e,["twitter","facebook","google"])&&(this.add_param("hide-reg",!0,!1),this.url.url="auth/"+e),"submit"==e&&this.set_callback("launch",function(){XBS.validation.submit_register(this)});break;case"topbar":this.url.defer=!1,this.unset("launch");break;case"orb_card":this.set_callback("launch",function(){var e=this.deferral_data;$(XSM.modal.primary_content).html(e),$($(XSM.modal.primary).find(".register-link.email")[0]).addClass(XSM.effects.active),XBS.menu.toggle_orb_card_row_menu("register",C.HIDE),setTimeout(function(){$(XSM.modal.primary).removeClass(XSM.effects.slide_up),setTimeout(function(){$("#registration-method-bar").addClass("diminish"),setTimeout(function(){$(XSM.modal.primary_deferred_content).removeClass(XSM.effects.slide_left)},XBS.data.delays.global_transition)},XBS.data.delays.global_transition)},XBS.data.delays.orb_card_row_toggle)})}},launch:function(){var e=$(this.modal).find(XSM.modal.deferred_content)[0],t=30;$("#registration-method-bar").addClass("diminish"),setTimeout(function(){$(".register-link.email").addClass(XSM.effects.active),this.deferral_data&&$(e).replaceWith($("<div/>").addClass([XSM.modal.deferred_content,XSM.effects.slide_left].join(" ")).html(this.deferral_data)),setTimeout(function(){$(e).removeClass(XSM.effects.slide_left)},t)},300)}}},this.submit_registration={modal:XSM.modal.primary,url:{url:!1,type:C.POST,defer:!0},params:{channel:{value:!1,url_fragment:!1}},callbacks:{launch:function(){"email"==this.read("channel")?XBS.validation.submit_register(this):this.url.url="auth"+C.DS+this.read("channel")}}},this},window.xtr.route_collections.vendor_ui=function(){return this.vendor_ui={params:{target:{url_fragment:!0}},url:{url:"vendor-ui",defer:!0,type:C.POST},modal:C.PRIMARY,callbacks:{params_set:function(){pr(this.read("target"),"vendor_ui")},launch:function(){"opts"==this.read("target")&&$("#menu-options-tab").replaceWith(this.deferral_data),"menu"==this.read("target")&&$("#menu-tab").replaceWith(this.deferral_data),$(document).foundation()}}},this.update_menu={params:{target:{url_fragment:!0},attribute:{url_fragment:!0}},url:{url:"orbs"+C.DS+"update_menu",type:C.POST,data:null},callbacks:{params_set:function(){var e=null;if("orbopts"==this.read("attribute"))e=$(XSM.vendor_ui.orbopt_config_form_wrapper).serialize();else{var t=as_id(["orb",this.read("target"),this.read("attribute")].join("-"));e=$("form",t).serialize()}switch(this.url={url:["orbs","update_menu",this.read("target"),this.read("attribute")].join(C.DS),type:C.POST,defer:!0,data:e},this.read("target")){case"pricedicts":"fetch"==this.read("attribute")&&(this.url={url:"add-price-labels",type:C.GET,defer:!1},this.modal=new Modal(C.PRIMARY),this.unset("launch")),"save"==this.read("attribute")&&(this.url={url:"add-price-labels",type:C.POST,defer:!0,data:$(XSM.vendor_ui.price_dict_update_form).serialize()},this.unset("modal"))}},launch:function(){var e=this;XT.router.cake_ajax_response(this.deferral_data,{callback:function(t,r){"pricedicts"==r.target&&$("#menu-tab").load("vendor-ui/menu",function(){XT.vendor_ui.fix_breakouts()}),e.modal&&e.modal.hide(),XT.vendor_ui.save_orb(r.target,r.attribute,"replace"in t?t.replace:null)},data:{target:this.read("target"),attribute:this.read("attribute")}},!0)}}},this.orb_edit={params:{id:{value:null},action:{},action_arg:{}},modal:C.PRIMARY,callbacks:{params_set:function(){switch(this.read("action")){case"delete":var e=as_id(["delete","orb",this.read("id")].join("-"));switch(this.read("action_arg")){case"confirm":$(e).addClass(XSM.effects.fade_out).removeClass(XSM.effects.hidden),setTimeout(function(){$(e).removeClass(XSM.effects.fade_out)},300),this.unset("launch");break;case"cancel":$(e).addClass(XSM.effects.fade_out),setTimeout(function(){$(e).addClass(XSM.effects.hidden)},300),this.unset("launch");break;case"delete":this.url={url:["delete-menu-item",this.read("id")].join(C.DS),type:C.POST,defer:!0},this.set_callback("launch",function(){XT.router.cake_ajax_response(this.deferral_data,{callback:function(){$(XSM.vendor_ui.menu_tab).load("vendor-ui/menu",function(){XT.vendor_ui.data_tables("menu"),XT.vendor_ui.fix_breakouts()})}},!0,!0)})}case"add":switch(this.read("action_arg")){case"create":this.url={url:"add-menu-item",type:C.GET,defer:!1},this.unset("launch");break;case"save":this.modal.hide(),this.url={url:"add-menu-item",type:C.POST,defer:!0,data:$(XSM.vendor_ui.orb_add_form,XSM.modal.primary).serialize()},this.set_callback("launch",function(){XT.router.cake_ajax_response(this.deferral_data,{callback:function(){$(XSM.vendor_ui.menu_tab).load("vendor-ui/menu",function(){XT.vendor_ui.data_tables("menu"),XT.vendor_ui.fix_breakouts()})}},!0,!0)})}}},launch:function(){XT.router.cake_ajax_response(this.deferral_data,{},!0,!0)}}},this.orb_config={params:["target","action","attribute"],callbacks:{params_set:function(){switch(this.read("action")){case"edit":XT.vendor_ui.edit_cell("orb",this.read("target"),this.read("attribute"));break;case"cancel":XT.vendor_ui.cancel_cell_editing("orb",this.read("target"),this.read("attribute"))}}}},this.orbopt_config={url:{url:"orbopt-config",method:C.GET},modal:C.PRIMARY,params:{id:{url_fragment:!0},action:{},action_arg:{}},callbacks:{params_set:function(){switch("launch"!=this.read("action")&&(this.unset("url"),this.unset("modal")),this.read("action")){case"add":this.url={url:"add-menu-option",type:C.POST,defer:!0,data:$(XSM.vendor_ui.add_orbopt_form).serialize()},this.set_callback("launch",function(){XT.router.cake_ajax_response(this.deferral_data,{callback:function(){XT.vendor_ui.reload_tab("opts")}},!0)});case"delete":var e=as_id(["delete","orbopt",this.read("id")].join("-"));switch(this.read("action_arg")){case"confirm":$(e).addClass(XSM.effects.fade_out).removeClass(XSM.effects.hidden),setTimeout(function(){$(e).removeClass(XSM.effects.fade_out)},300),this.unset("launch");break;case"cancel":$(e).addClass(XSM.effects.fade_out),setTimeout(function(){$(e).addClass(XSM.effects.hidden)},300),this.unset("launch");break;case"delete":this.url={url:["delete-menu-option",this.read("id")].join(C.DS),type:C.POST,defer:!0},this.set_callback("launch",function(){XT.router.cake_ajax_response(this.deferral_data,{callback:function(){$(XSM.vendor_ui.menu_options_tab).load("vendor-ui/opts",function(){XT.vendor_ui.data_tables("opts"),XT.vendor_ui.fix_breakouts()})}},!0)})}break;case"toggle":this.set_callback("launch",function(){XT.vendor_ui.toggle_orbopt(this.read("id"))});break;case"set_opt_state":this.set_callback("launch",function(){pr([this.read("id"),this.read("action_arg")]),XT.vendor_ui.set_orbopt_state(this.read("id"),this.read("action_arg"))});break;case"toggle_group":this.set_callback("launch",function(){XT.vendor_ui.toggle_orbopt_group($(this.trigger.event.target).val())});break;case"filter":this.set_callback("launch",function(){XT.vendor_ui.toggle_filter(this.read("id"))})}},launch:function(){var e=$(XSM.modal.primary_content).innerHeight(),t=$(XSM.modal.primary).innerHeight()-48;e>t&&$(XSM.modal.primary_content).css({height:t,overflowY:"auto"});var r,a,i,s=$(".content .orbopt span"),n=6;for(r=0,a=s.length;a>r;r+=n){i=s.slice(r,r+n);for(var o=0,l=0;6>l;l++)$(i[l]).innerHeight()>o&&(o=$(i[l]).innerHeight());for(var l=0;6>l;l++)$(i[l]).css({height:o})}$(document).foundation()}}},this.orbopt_edit={params:["id","action","attribute"],callbacks:{params_set:function(){switch(this.read("action")){case"breakout":this.unset("launch"),this.unset("url");var e=null;e="add_opt"==this.read("attribute")?XSM.vendor_ui.orbopt_add_breakout:XSM.vendor_ui.orbopt_pricelist_add_breakout,XT.vendor_ui.toggle_menu_options_breakout(e);case"edit":pr(this.trigger),XT.vendor_ui.edit_cell("orbopt",this.read("id"),this.read("attribute"));break;case"cancel":pr(this.trigger),XT.vendor_ui.cancel_cell_editing("orbopt",this.read("id"),this.read("attribute"));break;case"save":this.url={url:["update-orbopt",this.read("id"),this.read("attribute")].join(C.DS),type:C.POST,defer:!0,data:$("form",as_id(["orbopt",this.read("id"),this.read("attribute")].join("-"))).serialize()},this.set_callback("launch",function(){XT.router.cake_ajax_response(this.deferral_data,{callback:XT.vendor_ui.save_orbopt,data:{id:this.read("id"),attribute:this.read("attribute")}},!0,!0)})}}}},this.orbopt_pricelist={params:["action","action-arg","id"],callbacks:{params_set:function(){switch(this.read("action")){case"set":XT.vendor_ui.set_orbopt_pricelist_focus();break;case"launch":this.modal=new Modal(C.PRIMARY),this.url={url:["launch-orbopt-pricelist-config",this.read("id")].join(C.DS),type:C.GET,defer:!1},this.set_callback("launch",XT.vendor_ui.fix_breakouts);break;case"add":XT.vendor_ui.toggle_pricelist_add("reveal");break;case"edit":if("save"==this.read("action-arg")){var e=$("#orbopt-pricelist-select-form").data("opt");this.url={url:["save-orbopt-pricing-edit",this.read("id"),e].join(C.DS),type:C.POST,defer:!0,data:$("#orbopt-pricelist-add-edit-form").serialize()}}else XT.vendor_ui.edit_orbopt_pricelist();break;case"cancel-add":XT.vendor_ui.set_orbopt_pricelist_focus();break;case"cancel":$(XT.router).trigger(C.ROUTE_REQUEST,{request:"orbopt_edit/-1/cancel/pricing",trigger:{}});break;case"save":if("pricelist"==this.read("action-arg")){var e=$("#orbopt-pricelist-select-form",C.BODY).data("opt");this.url={url:["add-orbopt-pricelist",e].join(C.DS),type:C.POST,defer:!0,data:$("form",XSM.vendor_ui.orbopt_pricelist_add).serialize()}}"opt"==this.read("action-arg")&&(this.url={url:["update-orbopt",this.read("id"),"pricing"].join(C.DS),type:C.POST,defer:!0,data:$("#orbopt-pricelist-select-form",C.BODY).serialize()});break;case"delete":"delete"==this.read("action-arg")?this.url={url:["orbopt-pricing-delete",this.read("id")].join(C.DS),type:C.POST,defer:!0}:this.unset("launch"),XT.vendor_ui.delete_orbopt_pricelist(this.read("action-arg"))}},launch:function(){void 0!=this.deferral_data&&XT.router.cake_ajax_response(this.deferral_data,{},!0,!0)}}},this.orbopt_optgroup_config={url:{url:"orbopt-optgroup-config",type:C.GET},modal:C.PRIMARY,params:{id:{url_fragment:!0},action:{},action_arg:{}},callbacks:{params_set:function(){switch(this.read("action")){case"toggle":this.unset("url"),this.unset("modal"),this.unset("launch");var e=as_id(["optgroup",this.read("id"),"label"].join("-")),t="input[name='OrboptOrbcat["+this.read("id")+"]'";$(e).toggleClass(XSM.effects.active),$(t).val(0==$(t).val()?1:0);break;case"save":this.url={url:this.url.url,method:C.POST,defer:!0,data:$(XSM.vendor_ui.orbopt_optgroup_config_form).serialize()}}},launch:function(){if(void 0!=this.deferral_data){var e=this;XT.router.cake_ajax_response(e.deferral_data,{callback:function(){e.modal.hide()}},!0,!0)}var t,r,a,i=$(".content .orbopt-optgroup span"),s=6;for(t=0,r=i.length;r>t;t+=s){a=i.slice(t,t+s);for(var n=0,o=0;6>o;o++)$(a[o]).innerHeight()>n&&(n=$(a[o]).innerHeight());for(var o=0;6>o;o++)$(a[o]).css({height:n})}$(document).foundation()}}},this.orbflag_config={params:{orbopt:{url_fragment:!0},optflag:{url_fragment:!0}},url:{url:"optflag-config",type:C.POST,defer:!0},callbacks:{params_set:function(){this.url={url:["optflag-config",this.read("orbopt"),this.read("optflag")].join(C.DS),type:C.POST,defer:!0}},launch:function(){XT.router.cake_ajax_response(this.deferral_data,{callback:XT.vendor_ui.toggle_optflag,data:{orbopt:this.read("orbopt"),optflag:this.read("optflag")}},!0,!0)}}},this},XtremeRoute=function(e,t,r){return this.route_data=void 0,this.param_data=void 0,this.route_uid=void 0,this.route_name=void 0,this.request=void 0,this.trigger=void 0,this.modal=void 0,this.params=void 0,this.deferral_data=void 0,this.params_set_callback=void 0,this.launch_callback=void 0,this.post_init_callback=void 0,this.stash=!1,this.overlay=!1,this.__stop_propagation=!0,this.init(e,t,r),this},XtremeRoute.prototype={constructor:XtremeRoute,init:function(e,t,r){var a=0;if(a>0&&pr(r,"XtremeRoute::__init( request_obj )",2),this.route_data=$.extend(!0,{},t),this.request=r.request,this.trigger={event:r.trigger,element:r.trigger.currentTarget},this.param_data=r.request.split(C.DS).slice(1),"stash"in t&&(this.stash=t.stash),"modal"in t&&(this.modal=new Modal(t.modal)),this.url={url:void 0,type:void 0,defer:void 0},"url"in t&&this.set_url(t.url),this.__stop_propagation="propagates"in t?!t.propagates:!0,this.stop_propagation(),"params"in t)if(this.params={},is_array(t.params))for(var i=0;i<t.params.length;i++)this.params[t.params[i]]={value:!1,url_fragment:!1,post_init:!1};else for(var s in t.params)this.params[s]={value:!1,url_fragment:!1,post_init:!1},"value"in t.params[s]&&(this.params[s].value=t.params[s].value),"url_fragment"in t.params[s]&&(this.params[s].url_fragment=t.params[s].url_fragment===!0),"post_init"in t.params[s]&&(this.params[s].post_init=t.params[s].post_init===!0);"callbacks"in t&&("post_init"in t.callbacks&&(this.post_init_callback=t.callbacks.post_init),"params_set"in t.callbacks&&(this.params_set_callback=t.callbacks.params_set),"launch"in t.callbacks&&(this.launch_callback=t.callbacks.launch,$(this).on(C.ROUTE_LAUNCHED,this.launch_callback))),this.post_init_callback&&this.post_init_callback(),$(this).off(),this.route_uid="*"+this.route_name+"["+(new Date).getTime()+"]",this.set_params(),this.launch_callback&&$(this).on("route_launched",this.launch_callback)},__debug:function(e,t){return t?(is_array(t)&&(t=t.join(", ")),this.toString()+"::"+e+"("+t+")"):this.toString()+"::"+e+"#"},set_params:function(){if(0!=this.param_data.length){var e=0;e>0&&pr(this.param_data,"XtremeRoute::__set_params(param vals)");for(var t=Object.keys(this.params),r=0;r<t.length;r++)this.param_data[r]&&(this.params[t[r]].post_init||(this.params[t[r]].url_fragment&&(this.url.url+=C.DS+this.param_data[r]),"true"===this.param_data[r]&&(this.param_data[r]=!0),"	rue"===this.param_data[r]&&(this.param_data[r]="true"),"false"===this.param_data[r]&&(this.param_data[r]=!1),"\false"===this.param_data[r]&&(this.param_data[r]="false"),this.params[t[r]].value=this.param_data[r]));this.params_set_callback&&(e>1&&pr("Executing params_set callback.","XtremeRoute::__set_params()"),e>2&&pr(this.params,"XtremeRoute::__set_params()"),this.params_set_callback())}},read:function(e){var t=0;return t>0&&pr(e,"XtremRoute::read(param_str)"),e in this.params?(t>1&&pr("param_str found in this.params","XtremeRoute::read()"),this.params[e].value):null},set:function(e,t){var r=1;if(r>0&&pr({attr:e,value:t},"XtremeRoute::set(attr, value)"),e in this){switch(r>1&&pr(e+" in 'this'"),e){case"url":this.url={url:!1,type:!1,defer:!1};break;case"launch_callback":$(this).off(C.ROUTE_LAUNCHED),this.launch_callback=!1;break;case"modal":this.set_modal(t)}return this[e]}},set_callback:function(e,t){switch(e){case"launch":$(this).off(C.ROUTE_LAUNCHED),this.launch_callback=t;break;case"params_set":this.params_set_callback=t}},set_deferral_data:function(e){this.deferral_data=e},set_url:function(e){for(var t in e)this.url[t]=e[t]},stop_propagation:function(){return this.__stop_propagation&&isEvent(this.trigger.event)&&this.trigger.event.stopPropagation(),this.__stop_propagation},toString:function(){return"XtremeRoute["+this.route_name+"]"},unset:function(e){if(!is_array(e)){if(in_array(e,["launch","params_set","post_init"])&&(e+="_callback"),e in this){switch(e){case"url":this.url={url:!1,type:!1,defer:!1};break;case"launch_callback":$(this).off(C.ROUTE_LAUNCHED),this.launch_callback=!1;break;case"modal":this.modal=!1,this.modal_content=!1}return this[e]}return!1}for(var t in e)this.unset(e[t])},write:function(e,t,r){if(r||(r=this),e=e.split("."),e[0]in r){if(e.length>1){var r=r[e[0]];return this.write(e.slice(1).join("."),t,r)}return r[e[0]]=t,!0}return!1}},XtremeRouter=function(){return this.init(),this},XtremeRouter.prototype={constructor:XtremeRouter,route_data:{},init:function(){for(var e in XT.route_collections){e=XT.route_collections[e]();for(var t in e)this.route_data[t]=e[t]}var r=this;$(C.BODY).on(C.CLK,XSM.global.route,null,function(e){$(e.currentTarget).hasClass(XSM.effects.disabled)||$(r).trigger(C.ROUTE_REQUEST,{request:$(e.currentTarget).data("route"),trigger:e})}),$(C.BODY).on(C.CHANGE,XSM.global.onchange_route,null,function(e){$(e.currentTarget).hasClass(XSM.effects.disabled)||$(r).trigger(C.ROUTE_REQUEST,{request:$(e.currentTarget).data("changeroute"),trigger:e})}),$(this).on(C.ROUTE_REQUEST,function(e,t){this.launch(t)})},launch:function(e){var t=2;t>0&&pr([e],"XtremeRouter.launch(request_obj, event)",2);var r=e.request.split(C.DS)[0],a=this.route_data[r],i=new XtremeRoute(r,a,e),s=0;if(i.stash&&(s+=XT.orbcard.exposed_face==C.BACK?1860:900),i.modal&&(pr(i.modal),i.modal.hidden()||!i.url.url||i.url.defer||(s+=i.modal.hide()),i.modal.resize()),i.url.url){var n=!1;try{$.ajax({type:i.url.type?i.url.type:C.POST,url:[XT.host,i.url.url].join(C.DS),data:"data"in i.url?i.url.data:null,statusCode:{403:function(){this.launch("flash/fail"),n||(n=!0,$(i).trigger("route_launched","403_FORBIDDEN"))}},success:function(e){$(XSM.global.loading).addClass(XSM.effects.fade_out),i.stash&&XT.menu.stash(),setTimeout(function(){t>1&&pr([i,e],i.__debug("launch/success")),i.url.defer?i.set_deferral_data(e):(i.modal.content.set(e),i.modal.show()),n=!0,$(i).trigger(C.ROUTE_LAUNCHED,{launch_msg:"TRIGGERED_POST_SUCCESS"})},s)},fail:function(){$(XSM.global.loading).addClass(XSM.effects.fade_out),"fail_callback"in i?i.fail_callback():XT.layout.launch_route(XT.routes.fail_flash),n||(n=!0,$(i).trigger(C.ROUTE_LAUNCHED,{launch_msg:"FAIL_TRIGGER"}))},always:function(){$(XSM.global.loading).addClass(XSM.effects.fade_out),n||$(i).trigger(C.ROUTE_LAUNCHED,{launch_msg:"FALLBACK_TRIGGER"})}})}catch(o){pr(o),n||(n=!0,$(i).trigger(C.ROUTE_LAUNCHED,{launch_msg:"CAUGHT_EXCEPTION"})),$(this).trigger(C.ROUTE_REQUEST,{request:"flash"})}}else $(i).trigger(C.ROUTE_LAUNCHED,{launch_msg:"NO_AJAX"})},cake_ajax_response:function(e,t,r,a){a&&pr(e,"deferral DATA"),"<pre"==e.substr(0,4)&&($(XSM.modal.primary_content).html(e),setTimeout(function(){$(XSM.modal.primary).removeClass(XSM.effects.slide_up)},30));var i=$.parseJSON(e);if(r&&pr(i,"RESPONSE"),"success"in i)if(is_object(i.success)){for(var s in i.success)if(1!=i.success[s])return}else if(i.success!==!0)return;t&&void 0!=t.callback&&("data"in t?t.callback(i,t.data):t.callback(i)),void 0!=i.delegate_route&&$(this).trigger(C.ROUTE_REQUEST,{request:i.delegate_route,trigger:{}})},route_split:function(e,t,r){var a=e.split(C.DS);return isInt(t)?isInt(r)?a.slice(t,r):a.slice(t):a}};var allow_tab_out=!1;EffectChain.prototype={constructor:EffectChain,defaults:{interval:void 0,context:void 0},step_complete:createCustomEvent("ECStepComplete"),steps:[],step_template:{target:!1,context:"body",state:void 0,interval:void 0,next:void 0},exec_result:void 0,init:function(e){if($(this).on("ECStepComplete",function(e,t){this.exec_step(t.step_index,t.target)}),e){this.defaults=obj_merge(this.defaults,e);for(var t in this.defaults)this.defaults[t]&&(this.step_template[t]=this.defaults[t])}},add:function(e){if(is_array(e)){for(;e.length>0;)this.add(e.shift());return this}return e=obj_merge(this.step_template,e),e.exec=function(e,t){t||(t=e.target);var r=function(){if("attr"in e.state)for(var r in e.state.attr)$(t,e.context).attr(r,e.state.attr);if("add"in e.state){is_array(e.state.add)||(e.state.add=[e.state.add]);for(var a=0;a<e.state.add.length;a++)try{$(t).addClass(e.state.add[a](t))}catch(i){$(t).addClass(e.state.add[a])}}if("remove"in e.state){is_array(e.state.remove)||(e.state.remove=[e.state.remove]);for(var a=0;a<e.state.remove.length;a++)try{$(t).removeClass(e.state.remove[a](t))}catch(i){$(t).removeClass(e.state.remove[a])}}};if($(t,e.context).each(r),e.next)try{return e.next(t,e.context)}catch(a){try{try{var i=$(e.next.selector,context)}catch(a){var i=$(e.next.selector)}try{return i.slice(e.next.from,"to"in e.next?e.next.to:-1)}catch(a){return i[e.next.index]}}catch(a){return $(e.next)}}},this.steps.push(e),this},exec_step:function(e,t){var r=this,a=this.steps[e],i=a.exec(a,t);e++,this.steps.length>e?setTimeout(function(){$(r).trigger("ECStepComplete",{step_index:e,target:i})},a.interval):this.exec_result=i},duration:function(){for(var e=0,t=0;t<this.steps.length-1;t++)e+=this.steps[t].interval;return e},run:function(e){this.exec_step(0,e)}};var eChain=new EffectChain;eChain.add([{target:"li.inactive",context:"ul.top_menu",interval:300,state:{add:["active","focus"],remove:["inactive"],attr:{disabled:!1}},next:["div#breadcrumbs","div#topbar"]},{target:void 0,context:void 0,interval:150,state:{add:["focus",function(e){return $(e).hasClass("active enabled")?"disabled":void 0}],remove:["inactive",function(e){return $(e).hasClass("inactive disabled")?"enabled":void 0}]},next:function(e,t){return $(e).find("span.icon",t)[0]}}]),eChain.add([{target:"li.active",context:"div.topbar",interval:150,state:{add:["inactive"],remove:["active"]},next:function(e,t){return e}},{target:void 0,context:"li.active",interval:150,state:{add:["active"]},next:function(e,t){return $(e).data("pane")}},{interval:10,state:{add:["inbound"],remove:["hidden"]}},{target:".content-pane.active",interval:500,state:{add:["shelved-left"]}},{target:".content-pane.active",interval:10,state:{add:["hidden"],remove:["active"]}},{target:".conent-pane.inbound",interval:500,state:{add:["active"],remove:["shelved-left","inbound"]},next:function(e,t){return $(e).children("h1")[0]}},{interval:0,state:{remove:["fade-out"]}}]),XT.validate=function(e,t,r){window["validate_"+e](t,r)},window.XBS={store_status:function(){for(var e in XBS.data.store_status)"true"==XBS.data.store_status[e]&&(XBS.data.store_status[e]=!0),"false"==XBS.data.store_status[e]&&(XBS.data.store_status[e]=!1);var t,r,a,i;XBS.data.store_status.delivering?(a=C.DELIVERING,i=stripCSS(XSM.global.available)):(a=C.PICKUP_ONLY,i=stripCSS(XSM.global.unavailable)),XBS.data.store_status.open?(t=C.OPEN,r=stripCSS(XSM.global.available)):(t=C.CLOSED,r=["store-closed",stripCSS(XSM.global.unavailable)].join(" "),a=null),$(XSM.global.store_status).html(t).addClass(r),$(XSM.global.delivery_status).html(a).addClass(i)}};