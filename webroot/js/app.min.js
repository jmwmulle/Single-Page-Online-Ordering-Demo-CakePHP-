function array_remove(e,t,r){var a=e.slice((r||t)+1||e.length);return e.length=0>t?e.length+t:t,e.push.apply(e,a)}function isEvent(e,t){if(t&&pr(e,"isEvent:"+t),"object"!=typeof e)return!1;var r=["bubbles","cancelable","currentTarget","eventPhase","timeStamp","type"];for(i in r)return r[i]in e?!0:!1}function is_object(e){return"object"==typeof e&&null!=e}function is_array(e){return e instanceof Array}function isFloat(e){return e===+e&&e!==(0|e)}function isInt(e){return e===+e&&e===(0|e)}function is_string(e){return"string"==typeof e}function is_function(e){return"function"==typeof e}function isValidJSON(e,t){try{var r=JSON.parse(e);if(r&&"object"==typeof r&&null!==r)return t===!0?r:!0}catch(a){}return!1}function createCustomEvent(e,t){var r={bubbles:!0,cancelable:!1,eventPhase:0,type:e};if("object"==typeof t)for(var a in t)t.hasOwnProperty(a)&&(r[a]=t[a]);return jQuery.Event(e,r)}function is_mobile(){var e=!1;return function(t,r){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}function eTypeOf(e){return isEvent(e)?e.type:!1}function px_to_int(e){return Number(e.split("px")[0])}function as_id(e){return"string"==typeof e?"#"===e.substring(0,1)?e:"#"+e:!1}function camelcase_to_pep8(e){return str_to_lower(e.replace(/\W+/g,"-").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/([a-z\d])([0-9]{1,})/g,"$1_$2"))}function array_intersect(e,t){e=e.sort(),t=t.sort();for(var r=bi=0,a=[];r<e.length&&bi<t.length;)e[r]<t[bi]?r++:e[r]>t[bi]?bi++:(a.push(r),r++,bi++);return a}function as_class(e){return"string"==typeof e?"."===e.substring(0,1)?e:"."+e:!1}function sel_to_str(e){try{return e.replace("-"," ").replace("_"," ").toTitleCase()}catch(t){return pr(t,"ERROR:sel_to_str()"),e}}function now(){return(new Date).getTime()}function stripCSS(e){return"."==e.substring(0,1)||"#"==e.substring(0,1)?e.substring(1):e}function matchWindowHeight(e,t){var r=window.innerHeight;if("[object Array]"===Object.prototype.toString.call(t))for(var a=0;a<t.length;a++)r-=$(t[a]).innerHeight();else"int"==typeof t?r-=$(t).innerHeight():"int"==typeof t&&(r-=t);return $(e).css("min-height",r),!0}function flash(e){if("@clear"==e)return $("#flash-content").html(""),!0;var t='   <div id="flash-message" class="text-center error">       <span>'+e+"</span>   </div>";return $("#flash-content").html(t),!0}function cakeUrl(e,t,r,a){if(r){if(r.constructor===Array){var i=WWW+DS+APP+DS+e+DS+t+DS+r.join(DS);return a?pr(i):null,i}if(r.constructor===Object){var o="";for(p in r)o+=DS+r[p];var i=WWW+DS+APP+DS+e+DS+t+o;return a?pr(i):null,i}var i=WWW+DS+APP+DS+e+DS+t+DS+r;return a?pr(i):null,i}var i=WWW+DS+APP+DS+e+DS+t;return a?pr(i):null,i}function in_array(e,t){return t.indexOf(e)>-1}function pr(e,t,r){for(var a=(new Error).stack.split("\n").slice(2),i=[],o="Null",s="//nowhere",n="-1",l=0;l<a.length-1;l++){try{o=a[l].match(/^ at (.*) \(/)[1]}catch(d){}try{s="/"+a[l].match(/^.*\/\/[a-z.-]*\/(.*):[0-9]*:[0-9]*/)[1]}catch(d){}try{n=a[l].match(/^.*\/\/[a-z.-]*\/.*:([0-9]*):[0-9]*/)[1]}catch(d){}i.push(o+" in  "+s+":"+n)}console.log("\nPrinting From: "+i[0]+"\n");var c=1==r?"error":"log";t=t&&"string"==typeof t?"%c "+t+" ":"%c";var u="*",_=u.length,p="rgb(52, 61, 76)",h="rgb(247, 126, 239)";switch(r){case 1:var f="color:rgb(255,0,0); text-transform:uppercase; background-color:rgb(255,245,245); border:1px solid rgb(255,0,0);";break;case 2:var m="color:rgb(100,160,175); background-color:"+p+"; border:1px solid rgb(35,55,63); border-right:none;",b="color:rgb(100,160,175); background-color:"+p+"; border:1px solid rgb(35,55,63); border-left:none, border-right:none;",g="color:rgb(100,160,175); background-color:"+p+"; border:1px solid rgb(35,55,63); border-left:none;",v=t.replace("[","__LBRAC__"),v=v.replace("]","__RBRAC__"),v=v.replace(/__LBRAC__(.*)__RBRAC__/,"[%c$1%c]"),S=!1,X=!1;t!=v&&(t=v,S=!0),t=t.replace(/\((.*)\)/,"(%c$1%c) %c");var C=t.replace(/(#)/,"%c#%c %c");C!=t&&(X=!0,t=C);break;default:var f="color:rgb(0,150,0); text-transform:uppercase; background-color:rgb(245,245,245); border:1px solid rgb(220,220,220);"}var w="color:rgb(200,200,200); font-style:italics; display:inline-block; width: 12px; min-width:12px; max-width:12px;",$="color:rgb(0,0,100);",y="color:rgb(225,125,80); font-weight: bold",T="color:rgb(125,125,125); font-family:arial",k="color:#008cba; background-color:rgb(247,247,247); border:1px solid #008cba;",M="color:rgb(252,122,0); background-color:"+p+"; border-top:1px solid rgb(35,55,63); border-bottom:1px solid rgb(35,55,63);",x="color:"+h+"; background-color:"+p+"; border-top:1px solid rgb(35,55,63); border-bottom:1px solid rgb(35,55,63);",E="color:rgb(252,240,244); background-color:"+p+"; border-top:1px solid rgb(35,55,63); border-bottom:1px solid rgb(35,55,63);",O=2==r||3==r;if(O){switch(e){case e===!1:t+="%s",e="false";break;case e===!0:t+="%s",e="true";break;case null===e:t+="%s",e="null";break;case"undefined"==typeof e:t+="%s",e="undefined";break;case"number"==typeof e:break;default:t+="%O"}S?console[c](t,m,x,b,M,g,E,e):console[c](t,m,M,g,E,e)}else switch(e){case 0===e:console[c](t+"%c(int) %c",f,w,$,0);break;case 1===e:console[c](t+"%c(int) %c%s",f,w,$,1);break;case e===!1:console[c](t+"%c(bool) %c%s",f,w,y,"false");break;case e===!0:console[c](t+"%c(bool) %c%s",f,w,y,"true");break;case null===e:console[c](t+"%c(!def) %c%s",f,w,y,"null");break;case"undefined"==typeof e:console[c](t+"%c(!def) %c%s",f,w,y,"undefined");break;case"string"==typeof e:e.substring(0,_)===u?console[c](t+"%c%s",f,k," "+e.substring(1)+" "):console[c](t+"%c(str) %c%s",f,w,T,e);break;case"number"==typeof e:e%1===0?console[c](t+"%c(int) %c%s",f,w,$,e):console[c](t+"%c(float) %c%s",f,w,$,e);break;default:console[c](t+"%c(obj) %O",f,w,e)}return null}function tr(e){pr(e,"err",!0)}function split_path(e,t){if("string"!=typeof e)return!1;e=e.substr(-1,1)===t?e.substring(0,e.length-1):e,e=e.substr(0,1)===t?e.substring(1):e,e=e.replace("\\"+t,"$DIRECTORY_SEPARATOR").split(t);for(var r=0;r<e.length;r++)e[r].replace("$DIRECTORY_SEPARATOR",t);return e}function ucfirst(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}function str_to_lower(e){return e.charAt(0).toLowerCase()+e.slice(1).toLowerCase()}function str_to_upper(e){return e.toUpperCase()}function camel_to_snake(e){return e.replace(/([A-Z])/g,function(e){return"_"+e.toLowerCase()})}function title_to_snake(e){return e=str_to_lower(e[0])+e.slice(1),e.replace(/([A-Z])/g,function(e){return"_"+e.toLowerCase()})}function title_case(e){e=e.replace("_"," ").split(" ");for(var t=0;t<e.length;t++)e[t]=ucfirst(e[t]);return e.join(" ")}function flip(e){return 0===e||1===e?0==e:e===!1||e===!0?0==e:"0"===e||"1"===e?"0"==e:"true"===e||"false"===e?"false"==e:"True"===e||"False"===e?"False"==e:null===e||"undefined"===e?"NULL_NOT_BOOL":"BOOLEAN_NOT_PASSED"}function integer_keys(e,t){if(!is_object(e))return!1;if(is_array(e))return e;var r={};for(var a in e)try{r[Number(a)]=e[a]}catch(i){r[a]=e[a]}return r}function obj_values(e,t,r){var a=[],i=-1;if(0>t&&(t=e.length-Math.abs(t)),r||r==e.length,0>r&&(r=e.length-Math.abs(t)),r>t)throw"ValueError: end index cannot precede start index";for(var o in e)i++,i>=t&&r>=i&&a.push(e[o]);return a}function exists(e){return jQuery(e).length>0}function clearForm(e){$("#"+e)[0].reset()}function strpad(e,t,r,a,i){if("number"==typeof e&&(e=e.toString()),r=r?r:"0",i){var o=e.split(".")[1];if(o&&o.length>0){e+="."!=e.substring(0,1)?".":null;for(var s=0;i>s;s++)e+=toString(0)}}var n=t-e.length;if(1>n)return e;var l="";if(-1!==a){for(var d=0;n>d;d++)l+=r;return l+e}for(var d=0;n>d;d++)e+=r;return e}function copy(e){var t=null;if(is_array(e))t=Array();else{if("string"==typeof e)return""+e;if(!is_object(e))return isInt(e)||isFloat(e)?0+e:e===!0||e===!1?e===!0:null;t={}}for(var r in e)t[r]=e[r];for(var r in e.prototype)t.prototype[r]=e.prototype[r];return t}function obj_len(e){var t,r=0;for(t in e)e.hasOwnProperty(t)&&r++;return r}function b64JSON(e){return btoa(JSON.stringify(e))}function die(){function e(){Error.apply(this,arguments),this.name="ExitRequest"}throw e.prototype=Object.create(Error.prototype),new e("Exiting..")}function obj_merge(e,t){if(!is_object(e)||!is_object(t))throw"keys_obj and vals_obj must both be javascript objects";var r={};for(var a in e)r[a]=a in t?t[a]:e[a];for(var a in t)a in r||(r[a]=t[a]);return r}function inherits(e){function t(){}return t.prototype=e.prototype,new t}function tab_out(e,t,r){if(allow_tab_out)try{if(null===e&&(e="null"),e===!0&&(e="true"),e===!1&&(e="false"),r){var a={e_txt:e.message,e_stack:e.stack};e=sprintf("<pre>%s</pre>",JSON.stringify(a,null,"	"))}"string"!=typeof e&&(e=sprintf("<pre>%s</pre>",JSON.stringify(e,null,"	")));var i=$("<div/>").addClass("jsc-line");t||(t="----"),$(i).append($("<div/>").addClass("tout-label").html(t)),$(i).append($("<div/>").addClass("tout-text").html(e)),$("main#js-console").append(i)}catch(o){$("body").style({backgroundColor:"yellow"}),setTimeout(function(){$("body").css({backgroundColor:"yellow"}),$("main").hide(),$("body").append($("<div/>").css({marginTop:"80px"}).html(o.message))},250)}}function tout_show(e){allow_tab_out&&(e=e?e:"anon",$("h4#called-from").html(e),$("main").hide(),setTimeout(function(){$("main#js-console").show(),setTimeout(function(){$("main#js-console").css({position:"fixed",top:"80px",left:"0px",zIndex:9999999})},100)},50))}function XtremePrinter(){return this.printer_available=!1,this.ip=null,this.status=null,this.queue={},this.styles={},this.tab_out=function(e,t){tab_out(e,t)},this.tout_show=function(){tout_show()},this.style_template=function(){return{indent:0,scale:1,line_h:1,align:C.LEFT,bold:!1,underline:!1}},this.virtual_receipts=[],this.init=function(e){this.status=this.open_printer(e),this.add_style("default",0,"left",3,1.5,!1,!1),this.extend_style("center","default",{align:"center"}),this.extend_style("right","default",{align:"right"}),this.extend_style("orb_opt","default",{indent:2,scale:2}),this.add_style("h1",0,"center",7.5,5,!0,!1),this.extend_style("h2","h1",{scale:4,line_h:6}),this.extend_style("h3","h1",{scale:3,line_h:4.5}),this.extend_style("h4","h1",{scale:2,line_h:3}),this.extend_style("h5","h1",{scale:1,line_h:2})},this.dequeue=function(){var e,t={},r=0;for(var a in this.queue)0==r?e=this.queue[a]:t[a-1]=this.queue[a],r++;return this.queue=t,e},this.print_from_queue=function(){var e={success:!0,error:!1,line:null,queue_empty:!1,raw:null};if(this.queued()){var t=this.dequeue(),r=in_array(t.text,[C.CUT,C.FEED_CUT]);if(t.text!=C.CUT){in_array(t.text,C.FEED,C.FEED_CUT)&&(t.text=" \n");var a=this.print(t.text,t.style,r);a.success===!1&&(e.success=!1,e.error=a,e.line=t)}r&&this.cut(!0)}else this.cut(!0),e.queue_empty=!0;return e},this.queued=function(){return obj_len(this.queue)>0},this.open_printer=function(e){var t;return XBS.printer.is_xtreme_tablet(),t=e?Android.openPrinter(e):Android.openDefaultPrinter(),t=t.split(":"),t={success:1===parseInt(t[0]),error:"false"==t[1]?!1:t[1]},this.printer_available=t.success?!0:!1,this.ip=t.ip,this.status=t,t},this.play_order_tone=function(){if(XBS.printer.is_xtreme_tablet())Android.playTone();else{var e=new Audio(XSM.vendor.new_order_tone);e.play()}},this.feed_line=function(e){e||0==e||(e=1);for(var t=0;e>t;t++)this.queue_line(" \n","default")},this.queue_line=function(e,t,r){r||(r=0);var a=obj_len(this.queue);this.queue[a]=t?{style:t,text:e}:{style:"default",text:e},this.queue[a+1]={style:"default",text:" "}},this.has_virtual_receipts=function(){return is_array(this.virtual_receipts)?this.virtual_receipts.length>0:(this.virtual_receipts=[],!1)},this.queue_order=function(e){pr(e,"the order"),tab_out("arrived","queue_order()");try{this.queue_line(sprintf("Ordered At: %s",e.time),"h4",1),this.queue_line(sprintf("For: %s",e.order_method),"h2",1),e.order_method==C.DELIVERY&&(e.customer&&this.queue_line(e.customer,"center","h3"),e.address&&this.queue_line(e.address,"center","h3"),e.delivery_instructions&&this.queue_line(e.delivery_instructions,"h4")),this.queue_line(sprintf("Payment Status: %s",e.paid?"PAYED":"OWED"),"h3",1),this.queue_line(sprintf("Payment Type: %s",e.payment_method),"h4"),this.__queue_orb_list(e.food),this.queue_line(sprintf("TOTAL: $%s",e.price),"h2")}catch(t){return tab_out(t,"queue_order() error",!0),!1}return pr(this.queue,"the queue"),this.queue},this.add_style=function(e,t,r,a,i,o,s){return this.styles[e]={align:r?r:"left",line_h:a?a:1,scale:i?i:1,indent:t?t:0,bold:o?o:!1,underline:s?s:!1},!0},this.extend_style=function(e,t,r){try{var a=this.style_template();for(var i in a)a[i]=i in r?r[i]:this.styles[t][i];return this.styles[e]=a,{name:e,style:a}}catch(o){return o}},this.show_dialog=function(e,t){this.printer_available&&Android.showDialog(e,t)},this.print=function(e,t,r){pr({text:e,style:t,virtual_cut:r},"XtremePrinter::print(text, style, virtual_cut)",2),tab_out({text:e,style:t},"print()");var a=null,i=XBS.printer.styles[t];try{this.printer_available?a=Android.printText(e,1,i.align,i.line_h,i.scale,i.scale,i.indent,i.bold,i.underline):((r||0===this.virtual_receipts.length)&&this.virtual_receipts.unshift([]),this.virtual_receipts[0].push($("<li/>").addClass(["virtual-receipt",t]).html(e)),a={success:!0,error:!1})}catch(o){tab_out(o,"print error",!0)}return a},this.cut=function(e){Android.cut(e===!0?e:!1)},this.__queue_orb_list=function(e){try{for(var t in e){var r=e[t];try{this.queue_line(sprintf("$%s   (%s) x %s %s",r.price,r.quantity,r.size,t),"h4");for(var a in r.opts)this.queue_line(sprintf("%s: %s",r.opts[a].weight,r.opts[a].title),"orb_opt"),r.instructions&&this.queue_line(r.instructions,"opt_note")}catch(i){tab_out({e_txt:i.message,e_stack:sprintf("<pre>%s</pre>",JSON.stringify(i.stack,null,"	"))},"__format_orbs() error")}}}catch(i){tab_out({e_txt:i.message,e_stack:sprintf("<pre>%s</pre>",JSON.stringify(i.stack,null,"	"))},"__queue_orb_list() error")}return!0},this.render_virtual_receipt=function(){if(pr(this.virtual_receipts,"XtremePrinter::render_virtual_receipt()",2),!this.virtual_receipts.length){for(var e=$("<ul/>").attr("id","virtual-receipt").addClass("virtual-receipt-container"),t=0;t<this.virtual_receipts.length;t++){for(var r=$("<li />"),a=$("<ul />").addClass("virtual-receipt receipt"),i=0;i<this.virtual_receipts[t].length;i++)$(a).append(this.virtual_receipts[t][i]);$(r).append(a),$(e).append(r)}return $(C.BODY).append(e),this.virtual_receipts=[],!0}},this.is_xtreme_tablet=function(){return navigator.userAgent==C.XTREME_TABLET_USER_AGENT},this}function EffectChain(e){var t=Object();return t.defaults={interval:void 0,context:void 0},t.step_complete=createCustomEvent("ECStepComplete"),t.steps=[],t.step_template={target:!1,context:"body",state:void 0,interval:void 0,next:void 0},t.exec_result=void 0,t.init=function(e){$(this).on("ECStepComplete",function(e,t){this.exec_step(t.step_index,t.target)}),is_object(e)&&(this.defaults=obj_merge(this.defaults,e));for(var t in this.defaults)this.defaults[t]&&(this.step_template[t]=this.defaults[t]);return this},t.add=function(e){if(is_array(e)){for(;e.length>0;)this.add(e.shift());return this}return e=obj_merge(this.step_template,e),e.exec=function(e,t){t||(t=e.target);var r=function(){if("attr"in e.state)for(var r in e.state.attr)$(t,e.context).attr(r,e.state.attr);if("add"in e.state){is_array(e.state.add)||(e.state.add=[e.state.add]);for(var a=0;a<e.state.add.length;a++)try{$(t).addClass(e.state.add[a](t))}catch(i){$(t).addClass(e.state.add[a])}}if("remove"in e.state){is_array(e.state.remove)||(e.state.remove=[e.state.remove]);for(var a=0;a<e.state.remove.length;a++)try{$(t).removeClass(e.state.remove[a](t))}catch(i){$(t).removeClass(e.state.remove[a])}}};if($(t,e.context).each(r),e.next)try{return e.next(t,e.context)}catch(a){try{try{var i=$(e.next.selector,context)}catch(a){var i=$(e.next.selector)}try{return i.slice(e.next.from,"to"in e.next?e.next.to:-1)}catch(a){return i[e.next.index]}}catch(a){return $(e.next)}}},this.steps.push(e),this},t.exec_step=function(e,t){var r=this,a=this.steps[e],i=a.exec(a,t);e++,this.steps.length>e?setTimeout(function(){$(r).trigger("ECStepComplete",{step_index:e,target:i})},a.interval):this.exec_result=i},t.duration=function(){for(var e=0,t=0;t<this.steps.length-1;t++)e+=this.steps[t].interval;return e},t.run=function(e){this.exec_step(0,e)},t.init(e),t}$.fn.scrollTo=function(e,t,r){"function"==typeof t&&2==arguments.length&&(r=t,t=e);var a=$.extend({scrollTarget:e,offsetTop:50,duration:500,easing:"swing"},t);return this.each(function(){var e=$(this),t="number"==typeof a.scrollTarget?a.scrollTarget:$(a.scrollTarget),i="number"==typeof t?t:t.offset().top+e.scrollTop()-parseInt(a.offsetTop);e.animate({scrollTop:i},parseInt(a.duration),a.easing,function(){"function"==typeof r&&r.call(this)})})},String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,r){return"undefined"!=typeof e[r]?e[r]:t})}),String.prototype.toTitleCase||(String.prototype.toTitleCase=function(){return this.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}),$("#reset-form").click(function(){{var e=$(this).attr("data-refresh");$(this).attr("data-formid")}0==e?clearForm():location.reload()}),void 0==window.xtr&&(window.xtr={});var XSM={global:{activizing_list:"ul.activizing li",active_list_item:"li.active",ajaxLink:".ajax-link",available:".available",unavailable:".unavailable",footer:"footer",imageQueue:"#image-loading-queue",loadingScreen:"#loadingScreen",loading:"#topbar h4.loading",multi_activizing:".multi-activizing",page_content:"#page-content",preserve_aspect_ratio:".preserve-aspect-ratio",route:"*[data-route]",onchange_route:"*[data-changeroute]",store_status:"#store-status",delivery_status:"#delivery-status",unknown_status:"#delivery-status"},effects:{active:"active",activizing:"activizing",active_by_default:"default",breakout:".breakout",checked:"icon-checked",cancel:"cancel",active_plus:"active-plus",detach:"detach",disabled:"disabled",enabled:"enabled",exposed:"exposed",fade_out:"fade-out",fastened:"fastened",fill_parent:".fill-parent",flipped_x:"flipped-x",flipped_y:"flipped-y",float_label:"float-labeled",hidden:"hidden",inactive:"inactive",inelligible:"inelligible",launching:"launching",loading:"loading",lr_only:"lr-only",max_of_type:"max-of-type",overlay:"overlay",pressed:"pressed",slide_right:"slide-right",register_icon:"icon-orb-card-register",register_reveal:"icon-orb-card-register-reveal",secondary:"secondary",share_icon:"icon-orb-card-share",share_icon_reveal:"icon-orb-card-share-reveal",slide_down:"slide-down",slide_left:"slide-left",slide_up:"slide-up",solidify:"solidify",stash:"stash",success:"success",swap_width:"swap-width",transitioning:"transitioning",true_hidden:"true-hidden",unchecked:"icon-unchecked"},forms:{orb_order_form:"#orderOrbForm",order_address_form:"#orderAddressForm",users_form:"#UsersForm"},load:{dismissLSButton:"#dismiss-loading-screen",pizzaLoaderGIF:"#pizza-loader-gif",loadingMessage:"#loading-message",readyMessage:"#ready-message"},menu:{active_orb_name_3d_context:"#active-orb-name-3d-context",active_orb_name_front_face:"#active-orb-name-front-face",active_orb_name_back_face:"#active-orb-name-back-face",active_orbcat_menu_header:"#active-orbcat-menu-header",active_orb:".active-orbcat-item.active",active_orbcat_item:".active-orbcat-item",active_orbs_menu_item:"#active-orbs-menu li a",add_to_cart:".add-to-cart",cancel_order_button:"#cancel-order-button",confirm_order_button:"#confirm-order-button","double":".double",full:".full",left_side:".left-side",right_side:".right-side",float_label:"#float-label",inactive_sauce:".orb-opt.sauce.inactive",sauce:".orb-opt.sauce",orb_card_back:"#orb-card-back",ord_card_back_face:".ord-card-back-face",orb_card_content_container:".orb-card-content-container",orb_card_row_1:"#orb-card-row-1",orb_card_row_2:"#orb-card-row-2",orb_card_row_3:"#orb-card-row-3",orb_card_stage:"#orb-card-stage",orb_card_stage_menu:"#orb-card-stage-menu",orb_card_stage_menu_wrapper:"#orb-card-stage-menu-wrapper",orb_card_3d_context:"#orb-card-3d-context",orb_card_wrapper:"#orb-card-wrapper",orb_order_form:"#orderOrbForm",orb_order_form_orb_id:"#OrderOrbId",orb_order_form_orb_uid:"#OrderOrbUid",orb_order_form_inputs:"#orderOrbForm input",orb_order_form_orb_opts:"#orderOrbForm input.orb-opt-weight",orb_order_form_price_rank:"#OrderOrbPriceRank",orb_order_form_note:"#OrderOrbNote",orb_order_form_quantity:"#OrderOrbQuantity",orb_size_button:".orb-size-button",orbcat_menu_title_header:"#orbcat-menu-title h1",orbcat_menu_title_subtitle:"#orbcat-menu-title h1 span",orbcat_menu:"#orbcat-menu",orb_opt:".orb-opt",orb_opt_active:".orb-opt.active",orb_opt_container:"#orb-opts-container",orb_opt_icon:".orb-opt-coverage",orb_opt_icon_active:".orb-opt-coverage.active",orb_opt_filter:".orb-opt-filter",orb_opt_filters:"#orb-opt-filters",optflag_filter_header:"#optflag-filter-header",orb_opt_filter_span:".orb-opt-filter span",orb_opt_filter_span_checked:".orb-opt-filter span.icon-checked",orb_opt_filter_span_unchecked:".orb-opt-filter span.icon-unchecked",orb_opt_filter_all:".orb-opt-filter-all",orb_opt_weight:".orb-opt-weight",orb_opts_menu_header:"#orb-opts-menu-header",registration_panel:"#orb-card-register-panel",register_button:"#register.orb-card-button",share_button:"#like.orb-card-button",self:"main#menu",social_panel:"#orb-card-social-panel",tiny_orb_opts_list:"#tiny-orb-opts-list",tiny_orb_opts_list_wrapper:"#tiny-orb-opts-list-wrapper",tiny_orb_opts_list_item:".tiny-orb-opts-list-item",user_activity_panel:"#user-activity-panel",user_activity_panel_items:"#user-activity-panel li"},modal:{button:".modal-button",close_modal:"#close-modal",confirm_address_login_panel:"#confirm-address-login-panel",default_content:".default-content",deferred_content:".deferred-content",flash:"#flash-modal",finalize_order_button:"#finalize-order-button",on_close:"#on-close",orb_card:"#orbcard-modal",overlay:"#modal-overlay-container",payment_method_input:"#OrderPaymentMethod",primary:"#primary-modal",primary_content:"#primary-modal-content",primary_deferred_content:"#primary-modal-content .deferred-content",social:"#social-modal",splash:"#splash-modal",submit_order_address:"#submit-order-address",submit_order_button_wrapper:"#submit-order-button-wrapper"},splash:{self:"#splash",bar_contents:"#splash-bar-content",content:"#splash > .content",circle:"#splash-circle",circleWrap:"#splash-circle-wrapper",detached:"#splash .detach",fastened:"#splash .fastened",logo:"#splash-logo",logo_wrapper:"#splash-logo-wrapper",logoClone:"#splash-logo_fasten-clone",menu:"#menu",menu_wrapper:"#menu-wrapper",menu_spacer:"#menu-wrapper .spacer",modal:"#splash-modal",modalWrap:"#splash-modal-wrapper",modalContent:"#splash-modal .content",openingDeal:"grand-opening-deal",order:"#order",order_delivery:"#splash-order-delivery",order_delivery_wrapper:"order-delivery-wrapper",order_pickup_wrapper:"order-pickup-wrapper",order_pickup:"#splash-order-pickup",order_spacer:"#order-wrapper .spacer",preserve_aspect_ratio:"#splash *.preserve-aspect-ratio",splash_bar:"#splash-bar",splash_bar_wrapper:"#splash-bar-wrapper",splash_link:".splash-link"},topbar:{self:"#topbar",social_loading:"#social-loading",icon_row:"#topbar .icon-row",topbar_cart_button:"#top-bar-view-cart",hover_text_link:".topbar-social  a",hover_text_label:"#topbar-hover-text-label",hover_text_label_incoming:"#topbar-hover-text-label span.incoming",hover_text_label_outgoing:"#topbar-hover-text-label span.outgoing"},vendor:{self:"body#vendor",back_splash:"#back-splash",customer_name:"#customer-name",error_pane:"#error-pane",food_list:"#food-list",next_order:"#next-order",new_order_tone:"files/new_order_tone.mp3",accept_acknowledge:"#accept-acknowledge",order_accept_button:"#order-accept-button",order_accept_button_pressed:"#order-accept-button.pressed",order_content_detail:"#order-content-detail",order_content_sample:"#order-content-sample",order_count:"#order-count",order_count_bubble:"#pending-orders-count",order_reject_confirmation:"#order-reject-confirmation",order_address:"#order-title",pending_orders_list:"#pending-orders-list"},vendor_ui:{add_orbopt_form:"#OrboptVendorUiForm",menu_table:"#menu-table",menu_options_tab:"#menu-options-tab",menu_tab:"#menu-tab",orbopts_table:"#menu-options-table",orb_attr_display:"div.orb-attr.display",orb_attr_edit:"div.orb-attr.edit",orbopt_attr_display:"div.orbopt-attr.display",orbopt_attr_edit:"div.orbopt-attr.edit",orbopt_add_breakout:"#orbopt-add-breakout",orbopt_pricelist_add_breakout:"#orbopt-pricelist-add-breakout",orbopt_pricelist_add:"#orbopt-pricelist-add",orb_add_form:"#OrbAddForm",orbopt_config_form_wrapper:".orbopt-config-form",orbopt_optgroup_config_form:"#orbopt-optgroup-config-form",orbopt_selection_template:"#orbopt-selection-template",price_dict_update_form:".price-dict-update-form",ui_tabs:"#ui-tabs"},footer:{self:"footer#footer"},generated:{vendor_ui_opts_input:function(e){return"#orb-"+e+"-orbopts"},vendor_ui_opts_config_id:function(e){return"#orb-"+e+"-orbopts-config"},vendor_orb_desc:function(e,t){var r=t.opts,a="<li><ul class='orb'><li> &#8226; ";a+="<span class='size'>"+t.size.replace("in",'"')+"</span>",a+="<span class='title'>"+e+"</span></li>";for(var i in r)switch(a+="<li class='orb-opt'><span class='text'>"+r[i].title+"</span>",r[i].weight){case"D":a+='<span class="icon-double"></span></li>';break;case"L":a+='<span class="icon-left-side"></span></li>';break;case"R":a+='<span class="icon-right-side"></span></li>';break;default:a+="</li>"}return a+="</ul></li>"},vendor_orb_title:function(e,t){},order_form_opt_id:function(e){return e=e.split("-")[2],as_id("OrderOrbOrbopt"+e)},orb_card_row_content:function(e){return"#orb-card-row-"+e+" div.orb-card-content"},orb_opt_id:function(e){return as_id("orb-opt-coverage-"+e)},order_address_button:function(e){var t,r,a="confirm_address/submit"+C.DS+e,i='<a href="#" id="submit-order-address" class="',o='<a href="#" class="modal-button lrg bisecting cancel left""';return o+=' data-route="confirm_address/cancel'+C.DS+e+'">',o+='<span class="icon-circle-arrow-l"></span><span class="text">Cancel</span></a>',"menu"==e&&(t=["modal-button","lrg","bisecting","confirm","right"],r='<span class="text">OK!</span><span class="icon-circle-arrow-r"></span></a>'),"review"==e&&(o="",t=["modal-button","lrg","full-width","confirm"],r='<span class="text">BACK TO CHECKOUT!</span><span class="icon-circle-arrow-r"></span></a>'),i+=t.join(" ")+'" data-route="'+a+'">',o+i+r}},page_name:{vendor_ui:"Vendor Interface",splash:"Splash Page",menu:"Xtreme Menu"}},FX=XSM.effects,constants={PX:"px",POST:"POST",GET:"GET",CLK:"click",CHANGE:"change",CHECK:"check",DELIVERY:"delivery",PICKUP:"pickup",JUST_BROWSING:"just_browsing",UNCHECK:"uncheck",UNDEF:"undefined",MOUSEOVER:"mouseover",HOVER:"hover",MOUSEENTER:"mouseenter",MOUSEOUT:"mouseout",HIDE:0,SHOW:1,DS:"/",BODY:"body",ORDER_SPACER_FACTOR:.45,MENU_SPACER_FACTOR:.15,BACK_FACE:"back_face",FRONT_FACE:"front_face",MENU:"menu",DATABASE:"database",SESSION:"session",UPDATE_DB:"update_database",UPDATE_SESSION:"update_session",UNSET:-1,OPT:"opt",CANCEL:"cancel",ORB_CARD_REFRESH:"orb_card_refresh",ORDER_FORM_UPDATE:"order_form_update",ORDER_UI_UPDATE:"order_ui_update",ROUTE_LAUNCHED:"route_launched",ROUTE_REQUEST:"route_request",ORB_ROW_ANIMATION_COMPLETE:"orb_row_animation_complete",F:"",D:"<span class='icon-double tiny-opt icon-hnj-inline'></span>",R:"<span class='icon-right-side tiny-opt icon-hnj-inline'></span>",L:"<span class='icon-left-side tiny-opt icon-hnj-inline'></span>",ORBCARD:"orbcard",PRIMARY:"primary",SPLASH:"splash",FLASH:"flash",WEIGHT:"weight",REM:16,STASH:1,OL:3,STASH_OL:4,STOP:5,STASH_STOP:6,STOP_OL:8,STASH_OL_STOP:9,PENDING:0,ACCEPTED:1,REJECTED:2,ACCEPT:"accept",REJECT:"reject",CUT:"cut",FEED:"feed",FEED_CUT:"feed_cut",XTREME_TABLET_USER_AGENT:"xtreme-pos-tablet",EPOS_EXCEPTION:"com.epson.eposprint.EposException",OPEN:"OPEN",CLOSED:"CLOSED",DELIVERING:"DELIVERING",PICKUP_ONLY:"PICKUP ONLY",UNAVAILABLE:"UNAVAILABLE",CONFIGURING:"configuring",CONFIGURED:"configured"},C=constants;void 0===window.xtr&&(window.xtr={}),window.xtr.events={route_launched:createCustomEvent("route_launched"),orb_card_refresh:createCustomEvent(C.ORB_CARD_REFRESH),order_form_update:createCustomEvent(C.ORDER_FORM_UPDATE),order_ui_update:createCustomEvent(C.ORDER_UI_UPDATE),route_request:createCustomEvent(C.ROUTE_REQUEST),orb_row_animation_complete:createCustomEvent(C.ORB_ROW_ANIMATION_COMPLETE)},window.xtr.data={debug:!0,store_status:null,host_root_dirs:{xDev:"",xProd:"",xLoc:"/xtreme"},delays:{global_transition:300,default_js_refresh:30,orb_card_row_toggle:800,menu_stash_delay:900,fold_splash:3e3,splash_set_order_method:3900},cfg:{root:null,developmentMode:!0,minLoadTime:1,store_status_inspection_timeout:61e3}},window.xtr.route_collections.form_validation=function(){return this.validate_form={params:["target","context","delegate_route"],callbacks:{params_set:function(){switch(this.read("target")){case"address":XBS.validation.submit_address(this.read("context"),this.read("delegate_route"))}}}},this},window.xtr.route_collections.layout_api=function(){return this.flash={params:{type:{url_fragment:!1}},modal:XSM.modal.flash,behavior:C.OL,callbacks:{launch:function(){$(this.modal_content).html("<h5>Oh Noes!</h5><p>Something went awry there. Let us know so we can fix it!</p>"),$(this.modal).removeClass(XSM.effects.slide_up)}}},this.footer={params:["method"],callbacks:{launch:function(){$(XSM.global.footer).hasClass("reveal")&&($(XSM.global.footer).addClass("stow"),setTimeout(function(){$(XSM.global.footer).removeClass("reveal"),setTimeout(function(){$(XSM.global.footer).removeClass("stow")},30)},30)),$(XSM.global.footer).hasClass("reveal")||$(XSM.global.footer).addClass("reveal")}}},this.launch_apology={url:{url:"launch-apology",type:C.GET,defer:!0},modal:XSM.modal.primary,params:["action"],callbacks:{params_set:function(){"close"==this.read("action")&&(this.unset("url"),XBS.layout.dismiss_modal(this.modal))}}},this},void 0===window.xtr&&(window.xtr=window.xtr),window.xtr.route_collections.menu_ui=function(){
return this.favorite={params:{context:{value:null,url_fragment:!1}},url:{url:"favorite"},data:!1,callbacks:{modal:XSM.modal.flash,params:function(){this.data=$(XSM.menu.orb_order_form).serialize()},launch:function(e,t){pr(t)}}},this.menu={params:["reveal_method"],modal:!1,url:{url:"menu"},callbacks:{params_set:function(){"unstash"==this.read("reveal_method")&&(this.unset("url"),this.unset("launch_callback"),window.xtr.layout.dismiss_modal(XSM.modal.primary),setTimeout(function(){window.xtr.menu.unstash()},window.xtr.data.delays.global_transition))},launch:function(){window.xtr.splash.fold()}}},this.menuitem={url:{url:"menuitem"},params:{orb_id:{value:null,url_fragment:!0}}},this.orbcat={url:{url:"menu",defer:!0},params:{id:{value:null,url_fragment:!0},name:{}},callbacks:{launch:function(){window.xtr.menu.refresh_active_orbcat_menu(this.deferral_data)}}},this.orb_opt={params:["context","element","title","weight"],behavior:C.STOP,callbacks:{params_set:function(){switch(this.read("context")){case"form_update":this.read("weight")||this.write("params.title.value",title_case(this.read("title"))),window.xtr.menu.set_orbopt_form_state(this.read("element"),this.read("title"));break;case"weight":var e=$(this.trigger.element).parents(XSM.menu.orb_opt)[0];if($(e).hasClass(XSM.effects.active)&&this.trigger.event.stopPropagation(),$(this).hasClass(XSM.effects.inelligible))return;orbcard.toggle_orb_opt_icon(this.trigger.element,!0);break;case"opt":orbcard.toggle_orb_opt(this.read("element"),!0)}}}},this.optflag={params:["target","action"],callbacks:{params_set:function(){switch(this.read("action")){case"filter":window.xtr.menu.toggle_optflag(Number(this.read("target")),!1)}}}},this.load_orb={url:{url:"menu-item",defer:!0},params:{id:{url_fragment:!0}},callbacks:{launch:function(){window.xtr.routing.cake_ajax_response(this.deferral_data,{callback:function(e,t){window.xtr.menu.load_orb(t,e.data.view_data)},data:{id:this.read("id")}},!0,!0)}}},this.configure_orb={params:["id","rank"],callbacks:{params_set:function(){window.xtr.orbcard.load_orb_configuration(window.xtr.cart.configure(this.read("id"),this.read("rank")))},launch:function(){window.xtr.orbcard.show_back_face(this.read("rank"))}}},this.orb_card={params:["action","action_arg","data"],stop_propagation:!0,callbacks:{params_set:function(){var e=!1;switch(this.read("action")){case"add_to_cart":switch(this.read("action_arg")){case"confirm":this.url={url:"add-to-cart",type:C.POST,defer:!0,data:$(XSM.menu.orb_order_form).serialize()},e=function(){try{var e=JSON.parse(this.deferral_data);1==e.success&&window.xtr.cart.add_to_cart()&&window.xtr.layout.reveal_orb_card_modal()}catch(t){throw"Add to cart failed at server:\n "+this.deferral_data}};break;case"cancel":e=window.xtr.menu.reset_orb_card_stage()}break;default:e=function(){window.xtr.menu.toggle_orb_card_row_menu(this.read("action"),null)}}e&&this.set_callback("launch",e)}}},this},window.xtr.route_collections.modal_api=function(){return this.close_modal={params:["modal","on_close"],callbacks:{launch:function(){var e=$(XSM.modal[this.read("modal")]).find(XSM.modal.on_close)[0];e?window.xtr.layout.dismiss_modal(this.read("modal"),$(e).data("action")):window.xtr.layout.dismiss_modal(this.read("modal"),!1)}}},this.orbcard_modal={params:["action","target"],propagates:!1,modal:XSM.modal.primary,callbacks:{params_set:function(){switch(window.xtr.orbcard.show_front_face(),pr(this.p),this.p.action){case"continue_ordering":setTimeout(function(){window.xtr.layout.dismiss_modal(),window.xtr.orbcard.reset_stage()},900);break;case"view":this.url={url:["review",this.read("target")].join("-"),defer:!1,type:C.GET},this.change_behavior(C.STASH_STOP)}}}},this},window.xtr.route_collections.orders_api=function(){return this.order={params:["method","context"],url:{url:"review-order",type:C.GET,defer:!1},modal:XSM.modal.primary,callbacks:{params_set:function(){switch(this.read("method")){case"finalize":this.url={url:"orders"+C.DS+"finalize",defer:!0,data:$("#OrderReviewForm").serialize(),type:C.POST},this.set_callback("launch",function(){var e=$.parseJSON(this.deferral_data),t=this.trigger;if(!e.error&&e.order_id){var r="pending_order"+C.DS+e.order_id+C.DS+"launching";$(window.xtr.router).trigger(C.ROUTE_REQUEST,{request:r,trigger:t.event})}});break;case"review":"orb_card"==this.read("context")&&this.change_behavior(C.STASH_STOP)}},launch:function(e,t){if(this.deferral_data){var r=$.parseHTML(this.deferral_data);$(XSM.modal.primary).addClass(XSM.effects.slide_down),setTimeout(function(){var e=$(XSM.modal.primary).find(XSM.modal.default_content)[0];$(e).replaceWith(r),$(XSM.modal.primary).hide().removeClass(XSM.effects.slide_down).addClass(XSM.effects.slide_up).show(),setTimeout(function(){$(XSM.modal.primary).removeClass(XSM.effects.slide_up)},30)},300)}else window.xtr.cart.validate_order_review()}}},this.order_accepted={url:"order-accepted",modal:XSM.modal.primary},this.splash_order={params:{method:{value:null,url_fragment:!1}},callbacks:{launch:function(){$(XSM.splash.order_delivery).removeClass(XSM.effects.slide_left),$(XSM.splash.order_pickup).removeClass(XSM.effects.slide_right)}}},this.payment_method={params:["context","action"],callbacks:{params_set:function(){switch(this.read("context")){case"review_modal":window.xtr.modal.payment_method(this.read("action"))}}}},this.pending_order={params:{order_id:{value:null,url_fragment:!0},status:{value:null,url_fragment:!0}},modal:XSM.modal.primary,url:{url:"order-confirmation",defer:!0,type:C.POST},callbacks:{params_set:function(){switch(this.read("status")){case"launching":this.params.status={value:!0},this.url.defer=!1;var e={request:"pending_order"+C.DS+this.read("order_id")+C.DS+C.PENDING,trigger:this.trigger};setTimeout(function(){$(window.xtr.router).trigger(C.ROUTE_REQUEST,e)},3e3),this.unset("launch_callback")}},launch:function(){var e=$.parseJSON(this.deferral_data);switch(Number(e.status)){case C.REJECTED:break;case C.ACCEPTED:$(window.xtr.router).trigger(C.ROUTE_REQUEST,{request:"order_accepted",trigger:this.trigger});break;default:var t={request:"pending_order"+C.DS+this.read("order_id")+C.DS+C.PENDING,trigger:this.trigger};setTimeout(function(){$(window.xtr.router).trigger(C.ROUTE_REQUEST,t)},3e3)}}}},this.order_update={params:["source"],callbacks:{params_set:function(){orbcard.load_orb_configuration()}}},this.confirm_address={modal:XSM.modal.primary,url:{url:"confirm-address",type:C.GET,defer:!0},params:["context","restore"],callbacks:{params_set:function(){switch(this.read("context")){case"menu":this.url.defer=!1;break;case"cancel":switch(this.unset("url"),this.unset("launch"),this.read("restore")){case"menu":window.xtr.menu.unstash_menu(),$(window.xtr.router).trigger(C.ROUTE_REQUEST,{request:"set_order_method/menu/just_browsing",trigger:{}}),window.xtr.menu.set_order_method(C.JUST_BROWSING);break;default:window.xtr.layout.dismiss_modal(this.modal)}}},launch:function(){is_object(this.deferral_data)&&"modal"in this.deferral_data&&window.xtr.router.cake_ajax_response(this.deferral_data,{data:{context:this.read("context"),modal:this.modal,modal_content:this.modal_content}})}}},this.set_order_method={modal:XSM.modal.primary,url:{url:"order-method",type:C.POST,defer:!0},params:{context:{value:null,url_fragment:!0},method:{value:null,url_fragment:!0}},callbacks:{launch:function(){window.xtr.router.cake_ajax_response(this.deferral_data,{callback:function(e){window.xtr.data.Service=e.data.Cart.Service,window.xtr.menu.set_order_method(),window.xtr.cart.init(e.data.Cart)}},!0,!0)}}},this.set_user_address={params:["id","action"],callbacks:{params_set:function(){switch(this.read("action")){case"reveal":window.xtr.modal.order_method.reveal_user_addresses(this.read("id"));break;case"set":window.xtr.modal.order_method.populate_address_form(this.read("id"))}}}},this.cart={modal:XSM.modal.primary,params:["action","action_arg","data"],propagates:!1,callbacks:{params_set:function(){switch(pr(this,"PARAMS_SET 0"),this.read("action")){case"add":"cancel"==this.read("action_arg")?(this.unset(["url","launch"]),pr(this,"PARAMS_SET 1"),window.xtr.orbcard.reset_stage()):this.url={url:"add-to-cart",type:C.POST,defer:!0,data:$(XSM.menu.orb_order_form).serialize()};break;case"clear":this.url={url:"clear-cart",type:C.POST,defer:!0},this.unset("launch");break;case"review":this.url={url:"review-cart",type:C.GET,defer:!1},this.change_behavior(C.STASH_STOP),this.unset("launch")}},launch:function(){window.xtr.router.cake_ajax_response(this.deferral_data,{callback:function(e){pr(e,"add to cart resp."),window.xtr.cart.init(e.data.Cart),"delegate_route"in e||window.xtr.layout.reveal_orb_card_modal()}},!0,!0);try{var e=JSON.parse(this.deferral_data);if(e.success!==!0||!window.xtr.cart.add_to_cart())throw"Add to cart failed at server:\n "+this.deferral_data}catch(t){try{throw pr(JSON.parse(this.deferral_data),"cart->order",!0),"Add to cart failed at server:\n "+this.deferral_data}catch(t){throw"Add to cart failed at server:\n "+this.deferral_data}}}}},this},window.xtr.route_collections.tablet_ui=function(){return this.tablet_print={params:["context"],callbacks:{params_set:function(){var e=0;e>0&&pr(XBS.printer.queue,"ROUTE: print_from_queue");var t;switch(this.read("context")){case"vendor_accepted":t=XBS.printer.queued()?XBS.printer.print_from_queue():!1;break;case"line_complete":t=XBS.printer.queued()?XBS.printer.print_from_queue():!1,XBS.printer.queued()||XBS.printer.cut(!0)}t===!1&&this.unset("launch")},launch:function(){try{$(XBS.routing).trigger(C.ROUTE_REQUEST,{request:"print_from_queue/line_complete",trigger:{}})}catch(e){pr(e)}}}},this.tablet_fetch_pending={url:{url:"pending",defer:!0,type:C.GET},callbacks:{params_set:function(){var e=0;e>0&&pr("<no_args>","XBS.routing.vendor_get_pending()::params_set",2),XBS.vendor.last_check||(XBS.vendor.last_check=now(),this.unset("url")),now()-XBS.vendor.last_check<3e3&&this.unset("url")},launch:function(){if(this.url.url){XBS.vendor.last_check=now();var e=$.parseJSON(this.deferral_data);!e.error&&e.orders.length>0&&XBS.vendor.post_orders(e.orders)}setTimeout(function(){$(XBS.routing).trigger(C.ROUTE_REQUEST,{request:"vendor_get_pending",trigger:{}})},500)}}},this.tablet_reject={params:["state"],callbacks:{params_set:function(){switch(this.read("state")){case"unconfirmed":$(XSM.vendor.order_reject_confirmation).removeClass(XSM.effects.slide_left);break;case"confirm":this.url={url:"vendor-reject"+C.DS+XBS.vendor.current().id+C.DS+C.REJECTED,type:C.POST,defer:!0},this.set_callback("launch",function(){$.parseJSON(this.deferral_data);$(XSM.vendor.order_reject_confirmation).addClass(XSM.effects.slide_left)});break;case"cancel":$(XSM.vendor.order_reject_confirmation).addClass(XSM.effects.slide_left)}}}},this.tablet_accept={params:["method","context"],url:{url:"vendor-accept",type:C.POST,defer:!0},callbacks:{params_set:function(){this.url.url+=C.DS+XBS.vendor.current().id+C.DS+C.ACCEPTED,$(XSM.vendor.accept_acknowledge).show(),setTimeout(function(){$(XSM.vendor.accept_acknowledge).addClass(XSM.effects.exposed),setTimeout(function(){$(XSM.vendor.accept_acknowledge).removeClass(XSM.effects.exposed).hide()},300)},30),XBS.vendor.last_check=-1e5},launch:function(){var e=$.parseJSON(this.deferral_data);if(e.success){var t=XBS.vendor.current();XBS.vendor.pending_orders.shift(),XBS.vendor.current_order=null,XBS.vendor.last_check=now(),$(XSM.vendor.order_accept_button).removeClass(XSM.effects.launching),$(XSM.vendor.order_accepted).addClass(XSM.effects.fade_out),XBS.printer.queue_order(t),$(XBS.routing).trigger(C.ROUTE_REQUEST,{request:"print_from_queue/vendor_accepted",trigger:{}}),XBS.vendor.next()}}}},this},window.xtr.route_collections.user_accounts=function(){return this.login={url:{url:!1,type:C.POST},modal:XSM.modal.primary,params:{context:{},channel:{url_fragment:!0},restore:{}},callbacks:{params_set:function(){var e=this.read("context"),t=this.read("channel"),r=this.read("restore");switch(pr(this.params,"login::params"),e){case"confirm-address":switch(t){case"email":this.unset("url"),this.set_callback("launch",function(){$(XBS.routing).trigger(C.ROUTE_REQUEST,{request:"login/modal/email/confirm-address",trigger:this.trigger})});break;default:this.unset("url"),this.unset("modal"),this.set_callback("launch",function(){$(XSM.modal.confirm_address_login_panel).hide().removeClass(XSM.effects.true_hidden),setTimeout(function(){$(XSM.modal.confirm_address_login_panel).show("clip")},30)})}break;case"modal":this.url={url:"login/email",defer:!1,type:C.GET},r&&this.set_callback("launch",function(){pr("got here"),$("#on-close").replaceWith('<div id="on-close" class="true-hidden" data-action="restore/confirm_address"></div>')});break;default:"email"==t&&(this.url.url="login/email",this.url.type=C.GET,this.set_callback("launch",function(){pr("login/email"),pr(this.deferral_data)}))}},launch:function(){window.location="http://development-xtreme-pizza.ca/auth/"+this.read("channel")}}},this.register={modal:XSM.modal.primary,url:{url:"sign-up",type:C.POST,defer:!0},params:{context:{},channel:{value:null,url_fragment:!1},restore:{},hide_reg:{value:!1}},callbacks:{params_set:function(){var e=this.read("channel");switch(this.read("context")){case"modal":this.url.defer=!0,in_array(e,["email","submit"])&&(this.url.url=!1),in_array(e,["twitter","facebook","google"])&&(this.add_param("hide-reg",!0,!1),this.url.url="auth/"+e),"submit"==e&&this.set_callback("launch",function(){XBS.validation.submit_register(this)});break;case"topbar":this.url.defer=!1,this.unset("launch");break;case"orb_card":this.set_callback("launch",function(){var e=this.deferral_data;$(XSM.modal.primary_content).html(e),$($(XSM.modal.primary).find(".register-link.email")[0]).addClass(XSM.effects.active),XBS.menu.toggle_orb_card_row_menu("register",C.HIDE),setTimeout(function(){$(XSM.modal.primary).removeClass(XSM.effects.slide_up),setTimeout(function(){$("#registration-method-bar").addClass("diminish"),setTimeout(function(){$(XSM.modal.primary_deferred_content).removeClass(XSM.effects.slide_left)},XBS.data.delays.global_transition)},XBS.data.delays.global_transition)},XBS.data.delays.orb_card_row_toggle)})}},launch:function(){var e=$(this.modal).find(XSM.modal.deferred_content)[0],t=30;$("#registration-method-bar").addClass("diminish"),setTimeout(function(){$(".register-link.email").addClass(XSM.effects.active),this.deferral_data&&$(e).replaceWith($("<div/>").addClass([XSM.modal.deferred_content,XSM.effects.slide_left].join(" ")).html(this.deferral_data)),setTimeout(function(){$(e).removeClass(XSM.effects.slide_left)},t)},300)}}},this.submit_registration={modal:XSM.modal.primary,url:{url:!1,type:C.POST,defer:!0},params:{channel:{value:!1,url_fragment:!1}},callbacks:{launch:function(){"email"==this.read("channel")?XBS.validation.submit_register(this):this.url.url="auth"+C.DS+this.read("channel")}}},this},window.xtr.route_collections.vendor_ui=function(){return this.vendor_ui={params:{target:{url_fragment:!0}},url:{url:"vendor-ui",defer:!0,type:C.POST},modal:XSM.modal.primary,callbacks:{params_set:function(){pr(this.read("target"),"vendor_ui")},launch:function(){"opts"==this.read("target")&&$("#menu-options-tab").replaceWith(this.deferral_data),"menu"==this.read("target")&&$("#menu-tab").replaceWith(this.deferral_data),$(document).foundation()}}},this.update_menu={params:{target:{url_fragment:!0},attribute:{url_fragment:!0}},url:{url:"orbs"+C.DS+"update_menu",type:C.POST,data:null},callbacks:{params_set:function(){var e=null;if("orbopts"==this.read("attribute"))e=$(XSM.vendor_ui.orbopt_config_form_wrapper).serialize();else{var t=as_id(["orb",this.read("target"),this.read("attribute")].join("-"));e=$("form",t).serialize()}switch(this.url={url:["orbs","update_menu",this.read("target"),this.read("attribute")].join(C.DS),type:C.POST,defer:!0,data:e},this.read("target")){case"pricedicts":"fetch"==this.read("attribute")&&(this.url={url:"add-price-labels",type:C.GET,defer:!1},this.set_modal(XSM.modal.primary),this.unset("launch")),"save"==this.read("attribute")&&(this.url={url:"add-price-labels",type:C.POST,defer:!0,data:$(XSM.vendor_ui.price_dict_update_form).serialize()},this.unset("modal"))}},launch:function(){XT.routing.cake_ajax_response(this.deferral_data,{callback:function(e,t){"pricedicts"==t.target&&$("#menu-tab").load("vendor-ui/menu"),$(XT.routing).trigger(C.ROUTE_REQUEST,{request:"close_modal/primary",trigger:{}}),XT.vendor_ui.save_orb(t.target,t.attribute,"replace"in e?e.replace:null)},data:{target:this.read("target"),attribute:this.read("attribute")}},!0)}}},this.orb_edit={params:{id:{value:null},action:{},action_arg:{}},callbacks:{params_set:function(){switch(this.read("action")){case"delete":var e=as_id(["delete","orb",this.read("id")].join("-"));switch(this.read("action_arg")){case"confirm":$(e).addClass(XSM.effects.fade_out).removeClass(XSM.effects.hidden),setTimeout(function(){$(e).removeClass(XSM.effects.fade_out)},300),this.unset("launch");break;case"cancel":$(e).addClass(XSM.effects.fade_out),setTimeout(function(){$(e).addClass(XSM.effects.hidden)},300),this.unset("launch");break;case"delete":this.url={url:["delete-menu-item",this.read("id")].join(C.DS),type:C.POST,defer:!0},this.set_callback("launch",function(){XT.routing.cake_ajax_response(this.deferral_data,{callback:function(){$(XSM.vendor_ui.menu_tab).load("vendor-ui/menu",function(){XT.vendor_ui.data_tables("menu"),XT.vendor_ui.fix_breakouts()})}},!0,!0)})}case"add":switch(this.read("action_arg")){case"create":this.set_modal(XSM.modal.primary),this.url={url:"add-menu-item",type:C.GET,defer:!1},this.unset("launch");break;case"save":this.unset("modal"),this.url={url:"add-menu-item",type:C.POST,defer:!0,data:$(XSM.vendor_ui.orb_add_form,XSM.modal.primary).serialize()},this.set_callback("launch",function(){XT.routing.cake_ajax_response(this.deferral_data,{callback:function(){$(XSM.vendor_ui.menu_options_tab).load("vendor-ui/menu",function(){XT.vendor_ui.data_tables("menu"),XT.vendor_ui.fix_breakouts()})}},!0)})}}},launch:function(){XT.routing.cake_ajax_response(this.deferral_data,{},!0,!0)}}},this.orb_config={params:["target","action","attribute"],callbacks:{params_set:function(){switch(this.read("action")){case"edit":XT.vendor_ui.edit_cell("orb",this.read("target"),this.read("attribute"));break;case"cancel":XT.vendor_ui.cancel_cell_editing("orb",this.read("target"),this.read("attribute"))}}}},this.orbopt_config={url:{url:"orbopt-config",method:C.GET},modal:XSM.modal.primary,params:{id:{url_fragment:!0},action:{},action_arg:{}},callbacks:{params_set:function(){switch("launch"!=this.read("action")&&(this.unset("url"),this.unset("modal")),this.read("action")){case"add":this.url={url:"add-menu-option",type:C.POST,defer:!0,data:$(XSM.vendor_ui.add_orbopt_form).serialize()},this.set_callback("launch",function(){XT.routing.cake_ajax_response(this.deferral_data,{callback:function(){XT.vendor_ui.reload_tab("opts")}},!0)});case"delete":var e=as_id(["delete","orbopt",this.read("id")].join("-"));switch(this.read("action_arg")){case"confirm":$(e).addClass(XSM.effects.fade_out).removeClass(XSM.effects.hidden),setTimeout(function(){$(e).removeClass(XSM.effects.fade_out)},300),this.unset("launch");break;case"cancel":$(e).addClass(XSM.effects.fade_out),setTimeout(function(){$(e).addClass(XSM.effects.hidden)},300),this.unset("launch");break;case"delete":this.url={url:["delete-menu-option",this.read("id")].join(C.DS),type:C.POST,defer:!0},this.set_callback("launch",function(){XT.routing.cake_ajax_response(this.deferral_data,{callback:function(){$(XSM.vendor_ui.menu_options_tab).load("vendor-ui/opts",function(){XT.vendor_ui.data_tables("opts"),XT.vendor_ui.fix_breakouts()})}},!0)})}break;case"toggle":this.set_callback("launch",function(){XT.vendor_ui.toggle_orbopt(this.read("id"))});break;case"set_opt_state":this.set_callback("launch",function(){pr([this.read("id"),this.read("action_arg")]),XT.vendor_ui.set_orbopt_state(this.read("id"),this.read("action_arg"))});break;case"toggle_group":this.set_callback("launch",function(){XT.vendor_ui.toggle_orbopt_group($(this.trigger.event.target).val())});break;case"filter":this.set_callback("launch",function(){XT.vendor_ui.toggle_filter(this.read("id"))})}},launch:function(){var e=$(XSM.modal.primary_content).innerHeight(),t=$(XSM.modal.primary).innerHeight()-48;e>t&&$(XSM.modal.primary_content).css({height:t,overflowY:"auto"}),$(document).foundation()}}},this.orbopt_edit={params:["id","action","attribute"],callbacks:{params_set:function(){switch(this.read("action")){case"breakout":this.unset("launch"),this.unset("url");var e=null;e="add_opt"==this.read("attribute")?XSM.vendor_ui.orbopt_add_breakout:XSM.vendor_ui.orbopt_pricelist_add_breakout,XT.vendor_ui.toggle_menu_options_breakout(e);case"edit":pr(this.trigger),XT.vendor_ui.edit_cell("orbopt",this.read("id"),this.read("attribute"));break;case"cancel":pr(this.trigger),XT.vendor_ui.cancel_cell_editing("orbopt",this.read("id"),this.read("attribute"));break;case"save":this.url={url:["update-orbopt",this.read("id"),this.read("attribute")].join(C.DS),type:C.POST,defer:!0,data:$("form",as_id(["orbopt",this.read("id"),this.read("attribute")].join("-"))).serialize()},this.set_callback("launch",function(){XT.routing.cake_ajax_response(this.deferral_data,{callback:XT.vendor_ui.save_orbopt,data:{id:this.read("id"),attribute:this.read("attribute")}},!0,!0)})}}}},this.orbopt_pricelist={params:["action","action-arg","id"],callbacks:{params_set:function(){switch(this.read("action")){case"set":XT.vendor_ui.set_orbopt_pricelist_focus();break;case"launch":this.set("modal",XSM.modal.primary),this.url={url:["launch-orbopt-pricelist-config",this.read("id")].join(C.DS),type:C.GET,defer:!1},this.set_callback("launch",XT.vendor_ui.fix_breakouts);break;case"add":XT.vendor_ui.toggle_pricelist_add("reveal");break;case"edit":if("save"==this.read("action-arg")){var e=$("#orbopt-pricelist-select").val();this.url={url:["save-orbopt-pricing-edit",this.read("id"),e].join(C.DS),type:C.POST,defer:!0,data:$("#orbopt-pricelist-add-edit-form").serialize()}}else XT.vendor_ui.edit_orbopt_pricelist();break;case"cancel-add":XT.vendor_ui.set_orbopt_pricelist_focus();break;case"cancel":$(XT.routing).trigger(C.ROUTE_REQUEST,{request:"orbopt_edit/-1/cancel/pricing",trigger:{}});break;case"save":if("pricelist"==this.read("action-arg")){var e=$("#orbopt-pricelist-select-form",C.BODY).data("opt");this.url={url:["add-orbopt-pricelist",e].join(C.DS),type:C.POST,defer:!0,data:$("form",XSM.vendor_ui.orbopt_pricelist_add).serialize()}}"opt"==this.read("action-arg")&&(this.url={url:["update-orbopt",this.read("id"),"pricing"].join(C.DS),type:C.POST,defer:!0,data:$("#orbopt-pricelist-select-form",C.BODY).serialize()});break;case"delete":"delete"==this.read("action-arg")?this.url={url:["orbopt-pricing-delete",this.read("id")].join(C.DS),type:C.POST,defer:!0}:this.unset("launch"),XT.vendor_ui.delete_orbopt_pricelist(this.read("action-arg"))}},launch:function(){XT.routing.cake_ajax_response(this.deferral_data,{},!0,!0)}}},this.orbopt_optgroup_config={url:{url:"orbopt-optgroup-config",method:C.GET},modal:XSM.modal.primary,params:{id:{url_fragment:!0},action:{},action_arg:{}},callbacks:{params_set:function(){switch(this.read("action")){case"toggle":this.unset("url"),this.unset("modal"),this.unset("launch");var e=as_id(["optgroup",this.read("id"),"label"].join("-"))+" span",t="input[name='OrboptOrbcat["+this.read("id")+"]'";$(e).hasClass(XSM.effects.success)?($(e).removeClass(XSM.effects.success),$(e).addClass(XSM.effects.secondary),$(t).val(0)):($(e).addClass(XSM.effects.success),$(e).removeClass(XSM.effects.secondary),$(t).val(1));break;case"save":this.url={url:this.url.url,method:C.POST,defer:!0,data:$(XSM.vendor_ui.orbopt_optgroup_config_form).serialize()},this.set_callback("launch",function(){XT.routing.cake_ajax_response(this.deferral_data,null,!0,!0)})}},launch:function(){$(document).foundation()}}},this.orbflag_config={params:{orbopt:{url_fragment:!0},optflag:{url_fragment:!0}},url:{url:"optflag-config",type:C.POST,defer:!0},callbacks:{params_set:function(){this.url={url:["optflag-config",this.read("orbopt"),this.read("optflag")].join(C.DS),type:C.POST,defer:!0}},launch:function(){XT.routing.cake_ajax_response(this.deferral_data,{callback:XT.vendor_ui.toggle_optflag,data:{orbopt:this.read("orbopt"),optflag:this.read("optflag")}},!0,!0)}}},this},XtremeRoute=function(e,t){return this.__init(e,t),this},XtremeRoute.prototype={constructor:XtremeRoute,route_data:void 0,param_data:void 0,route_uid:void 0,route_name:void 0,request:void 0,trigger:{event:!1,element:!1},modal:void 0,url:{url:!1,type:!1,defer:!1},params:void 0,p:this.params,deferral_data:void 0,modal_content:void 0,params_set_callback:void 0,launch_callback:void 0,post_init_callback:void 0,stash:!1,overlay:!1,__stop_propagation:!0,__init:function(e,t){var r=0;if(r>0&&pr([e,t],this.__debug("init",["request_obj","event"])),this.request=e.request,this.trigger={event:t,element:t.currentTarget},this.route_name=e.request.split(C.DS)[0],this.param_data=e.request.split(C.DS).slice(1),this.route_data=window.xtr.router.route_data[this.route_name],"modal"in this.route_data&&(this.modal=this.route_data.modal,this.modal_content=this.route_data.modal+"-content"),"url"in this.route_data&&this.set_url(this.route_data.url),"propagates"in this.route_data&&0==this.route_data.propagates&&(this.__stop_propagation=!0),this.stop_propagation(),"params"in this.route_data)if(this.params={},is_array(this.route_data.params))for(var a=0;a<this.route_data.params.length;a++)this.params[this.route_data.params[a]]={value:!1,url_fragment:!1,post_init:!1};else for(var i in this.route_data.params)this.params[i]={value:!1,url_fragment:!1,post_init:!1},"value"in this.route_data.params[i]&&(this.params[i].value=this.route_data.params[i].value),"url_fragment"in this.route_data.params[i]&&(this.params[i].url_fragment=this.route_data.params[i].url_fragment===!0),"post_init"in this.route_data.params[i]&&(this.params[i].post_init=this.route_data.params[i].post_init===!0);return this.__set_behavior("behavior"in this.route_data?this.route_data.behavior:!1),"callbacks"in this.route_data&&("post_init"in this.route_data.callbacks&&(this.post_init_callback=this.route_data.callbacks.post_init),"params_set"in this.route_data.callbacks&&(this.params_set_callback=this.route_data.callbacks.params_set),"launch"in this.route_data.callbacks&&(this.launch_callback=this.route_data.callbacks.launch,$(this).on("route_launched",this.launch_callback))),this.post_init_callback&&this.post_init_callback(),this.route_uid="*"+this.route_name+"["+(new Date).getTime()+"]",this.launch_callback&&$(this).on("route_launched",this.launch_callback),this.__set_params(),!0},__debug:function(e,t){return t?(is_array(t)&&(t=t.join(", ")),this.toString()+"::"+e+"("+t+")"):this.toString()+"::"+e+"#"},__set_behavior:function(e){var t=0;switch(t>0&&pr(e,"Route::__set_behavior(behavior_mask)",2),e){case C.STASH:this.stash=!0,this.overlay=!1,this.__stop_propagation=!1;break;case C.OL:this.stash=!1,this.overlay=!0,this.__stop_propagation=!1;break;case C.STASH_OL:this.stash=!0,this.overlay=!0,this.__stop_propagation=!1;break;case C.STOP:this.stash=!1,this.overlay=!1,this.__stop_propagation=!0;break;case C.STASH_STOP:this.stash=!0,this.overlay=!1,this.__stop_propagation=!0;break;case C.OL_STOP:this.stash=!1,this.overlay=!0,this.__stop_propagation=!0;break;case C.STASH_OL_STOP:this.stash=!0,this.overlay=!0,this.__stop_propagation=!0;break;default:this.stash=!1,this.overlay=!1,this.__stop_propagation=!1}return!0},__set_params:function(){if(0!=this.param_data.length){var e=0;e>0&&pr(this.param_data,"XtremeRoute::__set_params(param vals)");for(var t=Object.keys(this.params),r=0;r<t.length;r++)this.param_data[r]&&(this.params[t[r]].post_init||(this.params[t[r]].url_fragment&&!this.url_append(this.param_data[r])&&e>1&&pr({param:t[r],value:this.param_data[r],params:this.params,values:this.param_data},"Route::url_append() failed",!0),"true"===this.param_data[r]&&(this.param_data[r]=!0),"	rue"===this.param_data[r]&&(this.param_data[r]="true"),"false"===this.param_data[r]&&(this.param_data[r]=!1),"\false"===this.param_data[r]&&(this.param_data[r]="false"),this.params[t[r]].value=this.param_data[r]));return this.params_set_callback&&(e>1&&pr("Executing params_set callback.","XtremeRoute::__set_params()"),e>2&&pr(this.params,"XtremeRoute::__set_params()"),this.params_set_callback()),!0}},init:function(e){$(this).off();var t=0;return t>0&&pr(e,"XtremeRoute::init_instance(param_values)"),this.route_name="*"+this.route_name+"["+(new Date).getTime()+"]",this.launch_callback&&$(this).on("route_launched",this.launch_callback),e&&this.__set_params(e),this},add_param:function(e,t,r){return this.params[e]={value:"undefined"!=t?t:!1,url_fragment:r===!0,post_init:!0},!0},change_behavior:function(e){this.__set_behavior(e)},read:function(e){var t=0;return t>0&&pr(e,"XtremRoute::read(param_str)"),e in this.params?(t>1&&pr("param_str found in this.params","XtremeRoute::read()"),this.params[e].value):null},set:function(e,t){var r=1;if(r>0&&pr({attr:e,value:t},"XtremeRoute::set(attr, value)"),e in this){switch(r>1&&pr(e+" in 'this'"),e){case"url":this.url={url:!1,type:!1,defer:!1};break;case"launch_callback":$(this).off(C.ROUTE_LAUNCHED),this.launch_callback=!1;break;case"modal":this.set_modal(t)}return this[e]}},set_callback:function(e,t){switch(e){case"launch":$(this).off(C.ROUTE_LAUNCHED),this.launch_callback=t;break;case"params_set":this.params_set_callback=t}this.init()},set_deferral_data:function(e){this.deferral_data=e},set_modal:function(e){this.modal=e,this.modal_content=e+"-content"},set_url:function(e){try{this.url.url="url"in e?e.url:!1,this.url.type="type"in e?e.type:C.GET,this.url.defer="defer"in e?e.defer:!1}catch(t){throw"Invalid url_hash supplied to Route.set_url:\n	 ["+t+"]"}},stop_propagation:function(){return this.__stop_propagation&&isEvent(this.trigger.event)&&this.trigger.event.stopPropagation(),this.__stop_propagation},toString:function(){return"XtremeRoute["+this.route_name+"]"},url_append:function(e){var t=0;return t>0&&pr(e,"Route::url_append(fragment)"),"string"==typeof e?(t>1&&pr("fragment length > 0; proceeding","Route::url_append()"),"string"==typeof e?(t>1&&pr("this.url.url length > 0; appending","Route::url_append()"),this.url.url+=C.DS+e):(t>1&&pr("this.url.url length didn't exist; creating","Route::url_append()"),this.url.url=e),!0):!1},unset:function(e){if(!is_array(e)){if(in_array(e,["launch","params_set","post_init"])&&(e+="_callback"),e in this){switch(e){case"url":this.url={url:!1,type:!1,defer:!1};break;case"launch_callback":$(this).off(C.ROUTE_LAUNCHED),this.launch_callback=!1;break;case"modal":this.modal=!1,this.modal_content=!1}return this[e]}return!1}for(var t in e)this.unset(e[t])},write:function(e,t,r){if(r||(r=this),e=e.split("."),e[0]in r){if(e.length>1){var r=r[e[0]];return this.write(e.slice(1).join("."),t,r)}return r[e[0]]=t,!0}return!1}},XtremeRouter=function(){return this.init(),this},XtremeRouter.prototype={constructor:XtremeRouter,route_data:{},XT:void 0,init:function(){this.XT=window.xtr;for(var e in this.XT.route_collections){e=this.XT.route_collections[e]();for(var t in e)this.route_data[t]=e[t]}var r=this;$(C.BODY).on(C.CLK,XSM.global.route,null,function(e){$(e.currentTarget).hasClass(XSM.effects.disabled)||$(r).trigger(C.ROUTE_REQUEST,{request:$(e.currentTarget).data("route"),trigger:e})}),$(C.BODY).on(C.CHANGE,XSM.global.onchange_route,null,function(e){$(e.currentTarget).hasClass(XSM.effects.disabled)||$(r).trigger(C.ROUTE_REQUEST,{request:$(e.currentTarget).data("changeroute"),trigger:e})}),$(this).on(C.ROUTE_REQUEST,function(e,t){this.launch(t,e)})},launch:function(e,t){var r=0;r>0&&pr([e,t],"XtremeRouter.launch(request_obj, event)",2);var a=new XtremeRoute(e,t),i=0,o=!1;if(a.stash&&(i+=900,this.XT.orb_card.exposed_face==C.BACK_FACE&&(i+=960)),in_array(a.modal,[XSM.modal.primary,XSM.modal.splash])&&(o=XSM.effects.slide_up),
o&&!$(a.modal).hasClass(o)&&0==a.url.defer&&(i+=300,this.XT.layout.dismiss_modal(a.modal,!1)),this.XT.layout.resize_modal(a.modal),a.url.url){var s=!1;try{$.ajax({type:a.url.type?a.url.type:C.POST,url:[this.XT.host,a.url.url].join(C.DS),data:"data"in a.url?a.url.data:null,statusCode:{403:function(){this.launch("flash/fail"),s||(s=!0,$(a).trigger("route_launched","403_FORBIDDEN"))}},success:function(e){$(XSM.global.loading).addClass(XSM.effects.fade_out),a.stash&&this.XT.menu.stash(),setTimeout(function(){r>2&&pr([a,e],a.__debug("launch/success")),a.url.defer?a.set_deferral_data(e):($(a.modal_content).html(e),o&&$(a.modal).removeClass(o)),$(a).trigger(C.ROUTE_LAUNCHED,{launch_msg:"TRIGGERED_POST_SUCCESS"})},i)},fail:function(){$(XSM.global.loading).addClass(XSM.effects.fade_out),"fail_callback"in a?a.fail_callback():this.XT.layout.launch_route(XT.routes.fail_flash),s||(s=!0,$(a).trigger(C.ROUTE_LAUNCHED,{launch_msg:"FAIL_TRIGGER"}))},always:function(){$(XSM.global.loading).addClass(XSM.effects.fade_out),s||$(a).trigger(C.ROUTE_LAUNCHED,{launch_msg:"FALLBACK_TRIGGER"})}})}catch(n){s||(s=!0,$(a).trigger(C.ROUTE_LAUNCHED,{launch_msg:"CAUGHT_EXCEPTION"})),$(this).trigger(C.ROUTE_REQUEST,{request:"flash"})}}else $(a).trigger(C.ROUTE_LAUNCHED,{launch_msg:"NO_AJAX"});return delete a,!0},cake_ajax_response:function(e,t,r,a){a&&pr(e,"deferral DATA"),"<pre"==e.substr(0,4)&&($(XSM.modal.primary_content).html(e),setTimeout(function(){$(XSM.modal.primary).removeClass(XSM.effects.slide_up)},30));var i=$.parseJSON(e);if(r&&pr(i,"RESPONSE"),"success"in i)if(is_object(i.success)){for(var o in i.success)if(1!=i.success[o])return}else if(i.success!==!0)return;this.XT.layout.dismiss_modal(XSM.modal.primary);try{"data"in t?t.callback(i,t.data):t.callback(i)}catch(s){}try{$(this).trigger(C.ROUTE_REQUEST,{request:i.delegate_route,trigger:{}})}catch(s){}},route_split:function(e,t,r){var a=e.split(C.DS);return isInt(t)?isInt(r)?a.slice(t,r):a.slice(t):a}};var allow_tab_out=!1,eChain=new EffectChain;eChain.add([{target:"li.inactive",context:"ul.top_menu",interval:300,state:{add:["active","focus"],remove:["inactive"],attr:{disabled:!1}},next:["div#breadcrumbs","div#topbar"]},{target:void 0,context:void 0,interval:150,state:{add:["focus",function(e){return $(e).hasClass("active enabled")?"disabled":void 0}],remove:["inactive",function(e){return $(e).hasClass("inactive disabled")?"enabled":void 0}]},next:function(e,t){return $(e).find("span.icon",t)[0]}}]),eChain.add([{target:"li.active",context:"div.topbar",interval:150,state:{add:["inactive"],remove:["active"]},next:function(e,t){return e}},{target:void 0,context:"li.active",interval:150,state:{add:["active"]},next:function(e,t){return $(e).data("pane")}},{interval:10,state:{add:["inbound"],remove:["hidden"]}},{target:".content-pane.active",interval:500,state:{add:["shelved-left"]}},{target:".content-pane.active",interval:10,state:{add:["hidden"],remove:["active"]}},{target:".conent-pane.inbound",interval:500,state:{add:["active"],remove:["shelved-left","inbound"]},next:function(e,t){return $(e).children("h1")[0]}},{interval:0,state:{remove:["fade-out"]}}]),XtremeLayout=function(){},XtremeLayout.prototype={page_name:void 0,constructor:XtremeLayout,page_height:void 0,init:function(){var e=this;this.jq_binds(),this.page_name==window.page_name.splash&&$(as_class(FX.detach)).each(function(){XBS.layout.detach(this)}),this.page_height=window.innerHeight-($(XSM.global.topbar).innerHeight()+3*C.REM)+C.PX,$(XSM.global.page_content).css({minHeight:e.page_height}),$(FX.fill_parent).each(function(){e.match_parent_dimensions(this)}),setTimeout(function(){$(XSM.topbar.social_loading).addClass(FX.fade_out),setTimeout(function(){$(XSM.topbar.social_loading).hide(),setTimeout(function(){$(XSM.topbar.icon_row).show(),setTimeout(function(){$(XSM.topbar.icon_row).removeClass(FX.fade_out),$(XSM.topbar.icon_row).removeClass(FX.true_hidden)},30)},30)},300)},800),is_mobile()||($(XSM.global.footer).css({top:$(XSM.global.page_content).innerHeight()}),this.fasten(XSM.menu.self).css({overflow:"hidden"}))},jq_binds:function(){var e=this;$(C.BODY).on(C.CLK,XSM.global.activizing_list,function(t){e.activize(t.currentTarget)}),$(C.BODY).on(C.CLK,XSM.global.multi_activizing,function(t){e.multi_activize(t.currentTarget)}),$(C.BODY).on(C.MOUSEENTER,as_class(FX.float_label),null,function(t){e.toggle_float_label($(t.currentTarget).data("float-label"),C.SHOW)}),$(C.BODY).on(C.MOUSEOUT,as_class(FX.float_label),null,function(t){e.toggle_float_label($(t.currentTarget).data("float-label"),C.HIDE)}),$(C.BODY).on(C.CLK,XSM.splash.splash_link,null,function(e){XBS.splash.redirect($(e.currentTarget).data("url"))}),$(C.BODY).on(C.MOUSEENTER,XSM.topbar.hover_text_link,null,function(t){$(t.currentTarget).hasClass(FX.disabled)||e.toggle_topbar_hover_text($(t.currentTarget).data("hover_text"))}),$(C.BODY).on(C.MOUSEOUT,XSM.topbar.hover_text_link,null,function(t){$(t.currentTarget).hasClass(FX.disabled)||e.decay_topbar_hover()}),window.page_name==XSM.page_name.splash&&$(window).on("resize",XBS.splash.render)},assert_aspect_ratio:function(e){return $(e).each(function(){$(this).removeAttr("style");var e=$(this).data("aspectRatio"),t=Number(e.x)/Number(e.y),r=e.respect;if(!isInt(t)&&!isFloat(t)){var a=t.split("/");if(2!==a.length)throw"Invalid value for argument 'ratio'; must be int, float or string matching n/m";t=Number(a[0])/Number(a[1])}var i={width:$(this).innerWidth(),height:$(this).innerHeight()};"y"!=r?i.height=i.width/t:i.width=i.height*t,$(this).css(i)}),!0},activize:function(e){isEvent(arguments[0])&&(e=e.currentTarget),$(e).hasClass(FX.inactive)&&$(e).removeClass(FX.inactive).addClass(FX.active).siblings(XSM.global.active_list_item).each(function(){$(this).removeClass(FX.active).addClass(FX.inactive)})},detach:function(e){var t=$(e).data("static"),r=$(e).innerHeight();return $(e).css({height:r}),t&&XBS.layout.fasten(e),$(e)},dismiss_modal:function(e,t){var r=0;if(r>0&&pr([e,t],"XBS.layout.dismiss_modal(modal, action)",2),$(XSM.modal.primary).addClass(FX.slide_up),$(XSM.modal.flash).addClass(FX.slide_up),$(XSM.modal.splash).addClass(FX.slide_up),$(XSM.modal.orb_card).hide("clip"),setTimeout(function(){$(XSM.modal.overlay).addClass(FX.fade_out),setTimeout(function(){$(XSM.modal.overlay).hide()},300)},300),t)switch(t){case"reset-user-activity":$(XSM.menu.user_activity_panel).children().each(function(){$(this).hasClass(FX.active)&&$(this).removeClass(FX.active).addClass(FX.inactive),$(this).hasClass(FX.active_by_default)&&$(this).addClass(FX.active)});break;case"unstash":window.menu.init(),window.menu.unstash_menu()}return!0},fasten:function(e){var t=0,r=is_array(e)?e:[e];for(var a in r){var i=r[a],o=$(i).offset(),s={width:Math.floor($(i).outerWidth()+px_to_int($(i).css("padding-left"))),height:Math.floor($(i).outerHeight()+px_to_int($(i).css("padding-top")))},n={position:"fixed",top:o.top,left:o.left,height:s.height,width:s.width};t>1&&pr(n),$(i).css(n).addClass(FX.fastened)}return is_array(e)?e:$(e)},hovertext_switch:function(e){var t=$("span.text.inactive",e)[0],r=$("span.text.active",e)[0];$(r,e).addClass(FX.fade_out),setTimeout(function(){$(t).removeClass([FX.hidden,FX.inactive].join(" ")).addClass(FX.active),$(r).removeClass(FX.active).addClass([FX.hidden,FX.inactive].join(" ")),setTimeout(function(){$(t).removeClass(FX.fade_out)},10)},300)},match_parent_dimensions:function(e){var t=$(e).parent();$(e).css({height:$(t).innerHeight(),width:$(t).innerWidth()})},multi_activize:function(e){$(e).hasClass("active")?$(e).removeClass("active").addClass("inactive").children(as_class(FX.checked)).each(function(){$(this).removeClass(FX.checked).addClass(FX.unchecked)}):$(e).hasClass("inactive")&&$(e).removeClass("inactive").addClass("active").children(as_class(FX.unchecked)).each(function(){$(this).removeClass(FX.unchecked).addClass(FX.checked)})},reveal_orb_card_modal:function(){$(XSM.modal.orb_card).show("clip")},resize_modal:function(e){if(e){var t,r,a,i;if(e==XSM.modal.primary){t=800,r=.8*$(window).innerHeight(),i=.1*$(window).innerHeight();var o=.8*$(window).innerWidth();a=o>t?($(window).innerWidth()-t)/2:.1*$(window).innerWidth(),t>o&&(t=o)}e==XSM.modal.flash&&(t=40*C.REM,a=window.innerWidth/2-t/2,r="default",i=2*C.REM),$(e).css({top:i,left:a,width:t,maxHeight:r})}},toggle_float_label:function(e,t){return t==C.SHOW&&$(XSM.menu.float_label).html(str_to_upper(e)).addClass(FX.exposed),t==C.HIDE&&$(XSM.menu.float_label).removeClass(FX.exposed).html(""),!0},toggle_loading_screen:function(){$(XSM.global.loadingScreen).fadeToggle()},toggle_topbar_hover_text:function(e,t){var r=!1;$(XSM.topbar.hover_text_label_outgoing).html()!=e&&(r&&pr([e,t],"toggle_topbar_hover_text(hover_text, state)"),$(XSM.topbar.hover_text_label_outgoing).removeClass("decay").addClass(FX.slide_right),$(XSM.topbar.hover_text_label_incoming).html(e).removeClass(FX.true_hidden),setTimeout(function(){$(XSM.topbar.hover_text_label_incoming).removeClass(FX.slide_left),setTimeout(function(){setTimeout(function(){$(XSM.topbar.hover_text_label_outgoing).remove(),setTimeout(function(){$(XSM.topbar.hover_text_label_incoming).removeClass("incoming").addClass("outgoing"),$(XSM.topbar.hover_text_label).append("<span class='incoming slide-left true-hidden'></span>")},10)},280)},10)},10))},decay_topbar_hover:function(){var e=(new Date).getTime();return $(XSM.topbar.hover_text_label_outgoing).addClass("decay "+e),setTimeout(function(){$(XSM.topbar.hover_text_label_outgoing+".decay."+e).addClass(FX.fade_out),setTimeout(function(){$(XSM.topbar.hover_text_label_outgoing+".decay."+e).replaceWith("<span class='outgoing'>Halifax loves pizza and we love halifax!</span>")},300)},1e3),!0}},XtremeMenu=function(){},XtremeMenu.prototype={constructor:XtremeMenu,XT:void 0,init:function(){this.XT=window.xtr,this.XT.page_name!=XSM.page_name.vendor_ui&&(this.XT.orbcard.reset_filters(C.CHECK),this.XT.cart.set_order_method())},add_to_cart:function(){$.ajax({type:C.POST,url:"orders/add_to_cart",data:$(XSM.menu.orb_order_form).serialize(),success:function(e){e=JSON.parse(e),1==e.success&&(XT.cart.add_to_cart(),$(XSM.modal.orb_card).show("clip"),$(XSM.topbar.topbar_cart_button).show(),setTimeout(function(){$(XSM.topbar.topbar_cart_button).removeClass(FX.fade_out)},300))}})},stash:function(){var e=0;this.orb_card.exposed_face==C.BACK_FACE&&(e=960,this.orb_card.show_front_face()),setTimeout(function(){$(XSM.menu.user_activity_panel).addClass(FX.slide_up),setTimeout(function(){$(XSM.menu.orb_card_wrapper).addClass([FX.slide_left,FX.fade_out].join(" ")),setTimeout(function(){$(XSM.menu.orbcat_menu).addClass([FX.slide_right,FX.fade_out].join(" "))},300)},300)},e)},unstash:function(){$(XSM.menu.orbcat_menu).removeClass([FX.slide_right,FX.fade_out].join(" ")),$(XSM.menu.orb_card_stage_menu).addClass(FX.activizing),setTimeout(function(){$(XSM.menu.orb_card_wrapper).removeClass([FX.slide_left,FX.fade_out].join(" ")),setTimeout(function(){$(XSM.menu.user_activity_panel).removeClass(FX.slide_up)},300)},300),XT.menu.set_order_method(),this.orbcard.reset_stage()}},XtremeCart=function(e){return this.init(e),this},XtremeCart.prototype={constructor:this.XtremeCart,configured:[],configuring:[],cart_id:void 0,initialized:!1,session_data:void 0,XT:void 0,init:function(e){var t=0;t>0&&pr(e,"XtremeCart.init(cart_id)",2),this.XT=window.xtr,this.cart_id=e,this.import_cart(!1)},import_cart:function(e){var t=this;if(!e)return void $.get(["cart",this.cart_id].join(C.DS),function(e){t.import_cart($.parseJSON(e).data)});this.session_data=e;for(var r in this.session_data.Order){var a=new Orb(r);a.import_data(e.Order[r]),this.find_by_uid(r)&&this["delete"](r,C.CONFIGURING),this.configured.push(a)}this.configuring=[]},is_uid:function(e){return e.split("_").length>1},generate_uid:function(e){return[e,now()].join("_")},id_from_uid:function(e){return e.split("_")[0]},cancel_config:function(e){var t=this.generate_uid(e);this.configuring[t]=new Orb(t)},"delete":function(e,t){for(var r=t==C.CONFIGURED?this.configured:this.configuring,a=0;a<r.length;a++)if(r[a].uid==e)return array_remove(r,a),!0;return!1},find_configuration:function(e){var t=this.is_uid(e)?this.find_by_uid(e):this.find_by_id(e,!0);return t?t[0]:!1},has_orb:function(e,t,r){var a=0,i=t?this.configuring:this.orbs;if(this.is_uid(e))a=e in i;else for(var o in i)i[o].id==e&&(a+=1);return r===!1?a>1||a===!0:a===!0?1:a===!1?0:a},add_to_cart:function(e){var t=this.generate_uid(e);return this.has_orb(t,!0)||this.configuring.push(new Orb(t)),!0},orb_attr:function(e,t,r){if(!this.has_orb(e,r))return!1;if(!t)return!1;if(t=this.html_id_from_attr(t),t.is_id)return this.id_from_uid(e);var a=r?this.configuring:this.orbs;if(t.str in a[e])return a[e][t.str];if(t.is_orbopt){if(!(t.opt_id in a[e].orbopts))return-1;try{if("weight"in a[e].orbopts[t.opt_id])return a[e].orbopts[t.opt_id].weight}catch(i){return a[e].orbopts[t.opt_id]}}return!1},find_by_uid:function(e,t){for(var r=t==C.CONFIGURED?this.configured:this.configuring,a=0;a<r.length;a++)if(r[a].uid==e)return[r[a]];return!1},find_by_id:function(e,t,r){for(var a=r==C.CONFIGURED?this.configured:this.configuring,i=[],o=0;o<a.length;o++)if(a[o].id==e){if(t)return[a[o]];i.push(a[o])}return i.length>0?i:!1},configure:function(e,t){var r=1;r>0&&pr(e,"XT.cart.configure()",2);var a=this.find_configuration(e);return a||(a=new Orb(this.generate_uid(e)),this.configuring.push(a)),t&&(a.price_rank=t),$(XSM.menu.orb_order_form_quantity).val(a.quantity),$(XSM.menu.orb_order_form_price_rank).val(a.price_rank),$(XSM.menu.orb_order_form_note).val(a.note),$(XSM.menu.orb_order_form_orb_opts).each(function(){a.orbopts.push=new Orbopt(new OrbInflector($(this).attr("id")).opt_id(),$(this).val())}),this.current_orb=a,a},set_order_method:function(e){e?this.XT.data.Service.order_method=e:e=this.data.Service.order_method,e||(this.data.Service.order_method=C.JUST_BROWSING,e=C.JUST_BROWSING),$(XSM.menu.user_activity_panel_items).each(function(){var t=$($(this).children()[0]).data("route");t&&(t.split(C.DS)[2]==e?$(this).removeClass(FX.inactive).addClass(FX.active):$(this).removeClass(FX.active).addClass(FX.inactive))})},weight_to_int:function(e){switch(e){case"-1":return-1;case"F":return 1;case"D":return 2;default:return.5}},inspect_configuration:function(e){{var t=this.find_by_uid(e);new OptflagMap}for(var r in t.orbopts){var a=t.orbopts[r];for(var i in a.optflags.length)if(a.optflags[i]in opt_weights){var o=this.weight_to_int(a.weight);this.pricable_optflags[a.optflags[i]]+=o>-1?o:0}}this.XT.menu.enforce_opt_rules(t,opt_weights)},validate_order_review:function(){var e=!0;this.XT.data.order.payment=$(XSM.modal.payment_method_input).val(),this.Service.order_method==C.JUST_BROWSING&&(e=!1),this.Service.order_method==C.DELIVERY&&(this.Service.address||(e=!1),this.Service.payment||(e=!1)),e&&$(XSM.modal.finalize_order_button).removeClass(XSM.effects.disabled)}};var xbs_validation={init:function(){return!0},submit_address:function(e,t){var r=2;r>0&&pr([e,t],"XBS.validation.submit_address(route)",2),$(XSM.forms.order_address_form).validate({debug:!0,rules:{"data[orderAddress][firstname]":"required","data[orderAddress][phone]":{required:!0,phoneUS:!0},"data[orderAddress][address]":"required","data[orderAddress][email]":{required:!0,email:!0},"data[orderAddress][postal_code]":{required:!0,minlength:6,maxlength:7}},messages:{"data[orderAddress][firstname]":"Well we have to call you <em>something!</em>","data[orderAddress][email]":"No spam, promisejust for sending receipts!","data[orderAddress][phone]":{required:"We'll need this in case there's a problem with your order.",phoneUS:"Just ten little digits, separated by hyphens if you like..."},"data[orderAddress][address]":"It's, err, <em>delivery</em> after all...","data[orderAddress][postal_code]":{required:"This is how we check if you're in our delivery area!",minlength:'Prooooobably something like "A0A 0A0"...',maxlength:'Prooooobably something like "A0A 0A0"...'}},submitHandler:function(){$.ajax({type:C.POST,url:"confirm-address/session",data:$(XSM.forms.order_address_form).serialize(),success:function(e){r>1&&pr(e,"XBS.validation.submit_address()->confirm_address_validation",2);try{XBS.layout.dismiss_modal(XSM.modal.primary),XBS.data.Service=e.cart.Service,XBS.menu.set_order_method()}catch(t){pr(t,null,!0)}}})}}),$(XSM.forms.order_address_form).submit()},submit_register:function(e){var t=0;t>0&&pr(e,"XBS.validation.submit_address(route)",2),$(XSM.forms.users_form).validate({debug:!0,rules:{"data[Users][firstname]":"required","data[Users][email]":{required:!0,email:!0},"data[Users][phone]":{required:!0,phoneUS:!0},"data[Users][address]":"required","data[Users][postal_code]":{required:!0,minlength:6,maxlength:7}},messages:{"data[Users][firstname]":"Well we have to call you <em>something!</em>","data[Users][email]":"This will be your 'username'. Don't worry, we won't share it or spam you!","data[Users][phone]":{required:"We'll need route in case there's a problem with your order.",phoneUS:"Jusst ten little digits, separated by hyphens if you like..."},"data[Users][address]":"It's, err, <em>delivery</em> after all...","data[Users][postal_code]":{required:"This is how we check if you're in our delivery area!",minlength:'Prooooobably something like "A0A 0A0"...',maxlength:'Prooooobably something like "A0A 0A0"...'}},submitHandler:function(){$.ajax({type:e.url.type,url:"users/add",data:$(XSM.forms.users_form).serialize(),success:function(e){},fail:function(){},always:function(){}})}}),$(XSM.forms.users_form).submit()}},xbs_vendor={pending_orders:[],last_check:0,last_tone_play:0,init:function(){var e=$("html").find(XSM.vendor.self)[0];e&&(XBS.data.is_vendor_page=!0,setTimeout(function(){$(XBS.routing).trigger(C.ROUTE_REQUEST,{request:"vendor_get_pending",trigger:{}})},3e3)),$(XSM.vendor.order_accept_button).on(C.VMOUSEDOWN,function(e){$(this).addClass(XSM.effects.pressed)});var t=function(e,t){var r="rgba(50,255,50,1)",a="rgba(125,185,232,1)",i="-webkit-linear-gradient(left, "+r+" "+e+"%,";return i+=a+" "+t+"%,"+a+" 100%)"};return $(C.BODY).on(C.VMOUSEMOVE,XSM.vendor.order_accept_button_pressed,null,function(e){var r=Math.round(100*(e.pageX-$(XSM.vendor.order_accept_button).offset().left)/512),a=Math.round(100*(e.pageX-$(XSM.vendor.order_accept_button).offset().left)/512)+1;95>r?$(XSM.vendor.order_accept_button).css({background:t(r,a)}):($(XSM.vendor.order_accept_button).attr("style",null),$(XSM.vendor.order_accept_button).addClass("launching"),$(XBS.routing).trigger(C.ROUTE_REQUEST,{request:"vendor_accept/print",trigger:this}))}),$(XSM.vendor.order_accept_button).on(C.VMOUSEOUT,function(e){$(this).removeClass(XSM.effects.pressed),$(XSM.vendor.order_accept_button).css({background:t(0,0)})}),$(XSM.vendor.order_accept_button).on(C.VMOUSEUP,function(e){$(this).removeClass(XSM.effects.pressed),$(XSM.vendor.order_accept_button).css({background:t(0,0)})}),!0},next:function(){var e=1;return e>0&&pr("<no_args>","XBS.vendor.next()",2),XBS.vendor.pending()?$(XBS.routing).trigger(C.ROUTE_REQUEST,{request:"vendor_get_pending",trigger:{}}):($(XSM.vendor.next_order).addClass(XSM.effects.slide_up),$(XSM.vendor.back_splash).show(),setTimeout(function(){setTimeout(function(){$(XSM.vendor.back_splash).removeClass(XSM.effects.fade_out),$(XBS.routing).trigger(C.ROUTE_REQUEST,{request:"vendor_get_pending",trigger:{}})},150)},150)),!0},current:function(e){return e&&(XBS.vendor.current_order=e),null===XBS.vendor.current_order?!1:XBS.vendor.current_order},pending:function(){var e=parseInt(XBS.vendor.pending_orders.length);return e>0?e:!1},post_orders:function(e){var t=0;t>0&&pr({orders:e,orders_length:e.length},"vendor.post_orders(orders)",2),XBS.vendor.pending_orders=e,XBS.vendor.update_pending_display(),XBS.vendor.update_current_order()},update_current_order:function(){if(!XBS.vendor.current()&&XBS.vendor.pending()){var e=$.parseHTML($(XSM.vendor.order_content_sample).html()),t=XBS.vendor.current(XBS.vendor.pending_orders[0]),r="";for(var a in t.food)r+=XSM.generated.vendor_orb_desc(a,t.food[a]);$($(e).find(XSM.vendor.order_address)[0]).html(t.address),$($(e).find(XSM.vendor.customer_name)[0]).html(t.customer),$($(e).find(XSM.vendor.food_list)[0]).html(r),$(XSM.vendor.next_order).hasClass(XSM.effects.slide_up)?($(XSM.vendor.order_content_detail).replaceWith(e),$(XSM.vendor.order_content_detail).removeClass(XSM.effects.fade_out),$(XSM.vendor.back_splash).addClass(XSM.effects.fade_out),setTimeout(function(){$(XSM.vendor.back_splash).hide(),setTimeout(function(){now()-XBS.vendor.last_tone_play>1e4&&(XBS.printer.play_order_tone(),XBS.vendor.last_tone_play=now()),$(XSM.vendor.next_order).removeClass(XSM.effects.slide_up)},30)},300)):($(XSM.vendor.order_content_detail).addClass(XSM.effects.fade_out),setTimeout(function(){$(XSM.vendor.order_content_detail).replaceWith(e),setTimeout(function(){$(XSM.vendor.order_content_detail).removeClass(XSM.effects.fade_out)},30)},300))}},update_pending_display:function(){var e=0,t=parseInt($(XSM.vendor.order_count).html()),r=XBS.vendor.pending_orders.length-1;return e>1&&pr([r,t],"vendor.update_pending_display()",2),$(XSM.vendor.order_count_bubble).removeClass(r>0?XSM.effects.fade_out:XSM.effects.fade_out),t!=r&&($(XSM.vendor.order_count).addClass(XSM.effects.fade_out),setTimeout(function(){$(XSM.vendor.order_count).html(r),setTimeout(function(){$(XSM.vendor.order_count).removeClass(XSM.effects.fade_out)},30)},150)),!0}},xbs_vendor_ui={orbopt_pricelist_id:-1,init:function(){XBS.vendor_ui.loading_screen(0),XBS.vendor_ui.fix_breakouts(),$(XSM.vendor_ui.ui_tabs).tabs();for(var e in{menu:null,opts:null})XBS.vendor_ui.data_tables(e)},loading_screen:function(e){var t=$(XSM.vendor_ui.ui_tabs).innerHeight();e==t?($("#loading-screen").addClass(FX.fade_out),setTimeout(function(){$("#loading-screen").addClass(FX.hidden)},300)):setTimeout(function(){XBS.vendor_ui.loading_screen(t)},300)},fix_breakouts:function(){$(FX.breakout).each(function(){$(this).css({left:.5*$(window).width()-400+"px",top:"300px"})})},data_tables:function(e){var t={menu:{id:XSM.vendor_ui.menu_table,cols:[{width:200},{width:400},{width:100},{width:350},{width:50}]},opts:{id:XSM.vendor_ui.orbopts_table,cols:[{width:100},{width:100},{width:76},{width:76},{width:76},{width:76},{width:76},{width:76}]}};$(t[e].id).dataTable({bDestroy:!0,bJQueryUI:!0,bDeferRender:!1,autoWidth:!1,columns:t[e]})},save_orb:function(e,t,r){var a=as_id(["orb",e,t].join("-")),i=null;switch(t){case"title":i=$("input[name='Orb[title]']",a).val(),$(XSM.vendor_ui.orb_attr_display,a).html(i);break;case"orbcat":var o=$("select",a).val();$($("select",a).find("option")).each(function(){Number($(this).attr("value"))==o?(i=$(this).text(),$(this).attr("selected","selected")):$(this).removeAttr("selected")}),$(XSM.vendor_ui.orb_attr_display,a).html(i);break;case"description":i=$("textarea",a).val(),$(XSM.vendor_ui.orb_attr_display,a).html(i);break;case"prices":$(a).html(r)}XBS.vendor_ui.cancel_cell_editing("orb",e,t)},set_orbopt_pricelist_focus:function(){$("#orbopt-pricelist-add input[name='Pricelist[id]']",C.BODY).val($("#orbopt-pricelist-select").val()),XBS.vendor_ui.toggle_pricelist_add("stow"),$("#orbopt-pricelist-buttons .modal-button.disabled",C.BODY).removeClass(FX.disabled).addClass(FX.enabled)},edit_orbopt_pricelist:function(){var e=["edit-orbopt-pricing",$("#orbopt-pricelist-select").val()].join(C.DS);$("#orbopt-pricelist-add-container").load([XBS.data.cfg.root,e].join(C.DS),function(){XBS.vendor_ui.toggle_pricelist_add("reveal",!0)})},toggle_pricelist_add:function(e,t){t&&"reveal"==e||$("input","#orbopt-pricelist-add-container").each(function(){$(this).val("")}),"reveal"==e&&($(".modal-button.enabled","#orbopt-pricelist-buttons").removeClass(FX.enabled).addClass(FX.disabled),$("#orbopt-pricelist-add-container").removeClass(FX.hidden),setTimeout(function(){$("#orbopt-pricelist-add-container").removeClass(FX.fade_out)},10)),"stow"==e&&($("#orbopt-pricelist-add-container").addClass(FX.fade_out),setTimeout(function(){$("#orbopt-pricelist-add-container").addClass(FX.hidden)},300))},delete_orbopt_pricelist:function(e){var t=$("#orbopt-pricelist-select").val();switch(e){case"confirm":$(XBS.routing).trigger(C.ROUTE_REQUEST,{request:["orbopt_pricelist","delete","delete",t].join(C.DS),trigger:{}});break;case"warn":$("#delete-orbopt-pricelist-confirmation").removeClass(FX.hidden),setTimeout(function(){$("#delete-orbopt-pricelist-confirmation").removeClass(FX.fade_out)},10);break;case"cancel":$("#delete-orbopt-pricelist-confirmation").addClass(FX.fade_out),setTimeout(function(){$("#delete-orbopt-pricelist-confirmation").addClass(FX.hidden)},300);break;case"print_opts":XBS.vendor_ui.delete_orbopt_pricelist("cancel"),XBS.vendor_ui.reload_orbopt_pricelist_config()}},reload_orbopt_pricelist_config:function(){var e=$("#orbopt-pricelist-select-form",C.BODY).data("opt");$(XBS.routing).trigger(C.ROUTE_REQUEST,{request:["orbopt_pricelist","launch","false",e].join(C.DS),trigger:{}})},edit_cell:function(e,t,r){var a=XSM.vendor_ui.orb_attr_display,i=XSM.vendor_ui.orb_attr_edit,o=as_id([e,t,r].join("-"));"orbopt"==e&&(a=XSM.vendor_ui.orbopt_attr_display,i=XSM.vendor_ui.orbopt_attr_edit),pr([e,t,r,o],"edit_cell"),$(a,o).addClass(FX.fade_out),setTimeout(function(){$(a,o).addClass(FX.hidden),$(i,o).removeClass(FX.hidden),setTimeout(function(){$(i,o).removeClass(FX.fade_out)},30)},300)},cancel_cell_editing:function(e,t,r){var a=XSM.vendor_ui.orb_attr_display,i=XSM.vendor_ui.orb_attr_edit,o=as_id([e,t,r].join("-"));"orbopt"==e&&(a=XSM.vendor_ui.orbopt_attr_display,i=XSM.vendor_ui.orbopt_attr_edit),pr([e,t,r,o],"cancel_cell_editing"),$(i,o).addClass(FX.fade_out),setTimeout(function(){$(i,o).addClass(FX.hidden),$(a,o).removeClass(FX.hidden),setTimeout(function(){$(a,o).removeClass(FX.fade_out)},30)},300)},save_orbopt:function(e,t){var r;switch("pricing"==t.attribute?(r=XSM.vendor_ui.orbopt_pricelist_add,$(r,C.BODY).addClass([FX.hidden,FX.fade_out].join(" "))):r=as_id(["orbopt",t.id,t.attribute].join("-")),t.attribute){case"title":$(XSM.vendor_ui.orbopt_attr_display,r).html(e.submitted_data.data.Orbopt.title);break;case"vendor-title":$(XSM.vendor_ui.orbopt_attr_display,r).html(e.submitted_data.data.Orbopt.vendor_title)}"replacement"in t&&$(XSM.vendor_ui.orbopt_attr_display,r).html(t.replacement),XBS.vendor_ui.cancel_cell_editing("orbopt",t.id,t.attribute)},toggle_orbopt_group:function(e){e=Number(e),$("li.orbopt",XSM.modal.primary).each(function(){var t=$(this).data();pr([e,t]),in_array(e,t.groups)?$(XBS.routing).trigger(C.ROUTE_REQUEST,{request:["orbopt_config",t.orbopt,"set_opt_state","active"].join(C.DS),trigger:{}}):$(XBS.routing).trigger(C.ROUTE_REQUEST,{request:["orbopt_config",t.orbopt,"set_opt_state","inactive"].join(C.DS),trigger:{}})})},set_orbopt_state:function(e,t,r,a){var i=r?r:"#orbopt-"+e+"-label",o=a?a:"li[data-orbopt='"+e+"'] input";t==FX.active&&($(i,XSM.modal.primary).removeClass(FX.active_plus).removeClass(FX.inactive).addClass(FX.active),$(o,XSM.modal.primary).val(1)),t==FX.inactive&&($(i,XSM.modal.primary).removeClass(FX.active).removeClass(FX.active_plus).addClass(FX.inactive),$(o,XSM.modal.primary).val(0)),t==FX.active_plus&&($(i,XSM.modal.primary).removeClass(FX.active).removeClass(FX.inactive).addClass(FX.active_plus),$(o,XSM.modal.primary).val(2))},toggle_filter:function(e){var t="#orbopt-flag-"+e;$(t,XSM.modal.primary).hasClass(FX.active)?$(t).removeClass(FX.active):$(t).addClass(FX.active),XBS.vendor_ui.filter_opts()},toggle_optflag:function(e,t){var r=t.orbopt,a=t.optflag,i=as_id(["orbopt",r,"optflag",a].join("-"));$("span",i).hasClass(FX.active)?$("span",i).removeClass(FX.active).addClass(FX.inactive):$("span",i).removeClass(FX.inactive).addClass(FX.active)},toggle_orbopt:function(e){var t="#orbopt-"+e+"-label",r="li[data-orbopt='"+e+"'] input",a=null;a=$(t,XSM.modal.primary).hasClass(FX.active)?FX.active_plus:$(t,XSM.modal.primary).hasClass(FX.active_plus)?FX.inactive:FX.active,XBS.vendor_ui.set_orbopt_state(e,a,t,r)},filter_opts:function(){var e=new Array;$("dd.orbopt-flag.active").each(function(){e.push(Number($(this).data("id")))}),$("li.orbopt",XSM.modal.primary).each(function(){var t=$(this).data("flags"),r=!1;for(var a in t)e.indexOf(t[a])>-1&&(r=!0);r?$(this).removeClass(FX.hidden):$(this).addClass(FX.hidden),$(document).foundation()})},reload_tab:function(e){"opts"==e&&($(XSM.vendor_ui.menu_options_tab).html(""),$(XSM.vendor_ui.menu_options_tab).load(["vendor-ui","opts"].join(C.DS),function(){XBS.vendor_ui.data_tables(e),XBS.vendor_ui.fix_breakouts()})),$(XSM.vendor_ui.menu_tab).load(["vendor-ui","menu"].join(C.DS),function(){XBS.vendor_ui.data_tables(e),XBS.vendor_ui.fix_breakouts()})},toggle_menu_options_breakout:function(e){$(e,XSM.vendor_ui.menu_options_tab).hasClass(FX.hidden)?$(e,XSM.vendor_ui.menu_options_tab).removeClass(FX.hidden):$(e,XSM.vendor_ui.menu_options_tab).addClass(FX.hidden)}};window.XBS={store_status:function(){for(var e in XBS.data.store_status)"true"==XBS.data.store_status[e]&&(XBS.data.store_status[e]=!0),"false"==XBS.data.store_status[e]&&(XBS.data.store_status[e]=!1);var t,r,a,i;XBS.data.store_status.delivering?(a=C.DELIVERING,i=stripCSS(XSM.global.available)):(a=C.PICKUP_ONLY,i=stripCSS(XSM.global.unavailable)),XBS.data.store_status.open?(t=C.OPEN,r=stripCSS(XSM.global.available)):(t=C.CLOSED,r=["store-closed",stripCSS(XSM.global.unavailable)].join(" "),a=null),$(XSM.global.store_status).html(t).addClass(r),$(XSM.global.delivery_status).html(a).addClass(i)}};